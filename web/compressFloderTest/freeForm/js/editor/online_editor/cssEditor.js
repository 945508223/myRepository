var id=YCDCommon.Win.getUrlParam("ds_id");var ds_name=YCDCommon.Win.getUrlParam("ds_name");var ispro=YCDCommon.Win.getUrlParam("ispro");var themeCode="idea";var css_Text=getCssText();function getCssText(){try{if(id&&id==="PAGE"){if(parent.VUECFG.pageArr&&parent.VUECFG.pageArr.length>0){var e=parent.VUECFG.pageArr;for(var t=0;t<e.length;t++){if(e[t].info.ds_name==="ds_pagecss"){themeCode=e[t].info.ds_theme;return e[t].info.ds_csseditor}}}}else if(id){var r=parent.$DS.getCtrlById(id).info;themeCode=r.ds_theme?r.ds_theme:"idea";return r[ds_name]}}catch(e){console.log("获取CSS失败!");console.log(e)}}let cm_opt={mode:"text/html",gutter:false,lineNumbers:true,autoCloseBrackets:true,styleActiveLine:true,theme:themeCode,lineWrapping:true,foldGutter:true,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Alt-/":"autocomplete"},matchBrackets:true,matchTags:{bothTags:true},autoCloseTags:true};Object.assign(cm_opt,{mode:"text/css"});let css_editor=CodeMirror.fromTextArea(document.getElementById("code-css"),cm_opt);if(css_Text)css_editor.setValue(css_Text);$("#sure").bind("click",function(){save_Css()});$("#cancle").bind("click",function(){close_()});function save_Css(){var e=css_editor.getValue();parent.$DS.setPro(id,ds_name,ispro=="true"?"csseditor":"input",e);close_();if(parent.VUECFG&&parent.VUECFG.VUECFG.viewStatu===false)parent.alert("请保存设计界面!</br>否则设置的CSS样式将不会加载!")}function selectTheme(e){css_editor.setOption("theme",e.target.value)}