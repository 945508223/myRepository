var $button={type:"drag_button",dataType:"singeleData",uuid:Date.parse(new Date),getConfig:getButtonConfig,register:registerButton,showProperty:showPropertyButton,setData:setBtnVal,getData:getBtnVal,clearData:clearBtnVal};function getButtonConfig(){return{ds_id:"",ds_ctrlname:"BUTTON_"+$button.uuid++,ds_show:true,ds_showCondition:"",ds_width:"100%",ds_height:"5rem",ds_labelwidth:"10",ds_labelcolor:"#606266",ds_labelfontweight:"bold",ds_labelfontfamily:"微软雅黑",ds_labelfontsize:"1",ds_innerwidth:"calc(100% - 0rem)",ds_style:"drawing-item",ds_datasource:"",ds_name:"",ds_showlable:false,ds_isrequired:false,ds_param:"",ds_backParamCondition:"",ds_trigger:"",ds_loading:"normal",ds_out_margin:"0rem",ds_in_padding:"0.5rem 1rem",ds_ispro:false,ds_pid:"",ds_draggable:"true",ds_labeltxt:"按钮",ds_button:"按钮",ds_size:"medium",ds_type:"primary",ds_icon:"el-icon-search",ds_plain:false,ds_round:false,ds_circle:false,ds_disabled:false,ds_button_height:"100%",ds_button_background_color:"",ds_button_background_hover_color:"",ds_button_fontsize:"1rem",ds_button_fontweight:"normal",ds_button_fontfamily:"微软雅黑",ds_button_color:"white",ds_button_hover_color:"",ds_button_zIndex:1999,ds_btn_data:"",ds_button_borderwidth:"0px",ds_button_bordercolor:"rgba(204, 204, 204, 1)",ds_button_borderstyle:"solid",ds_button_horizontally:"center",ds_button_vertically:"center",ds_button_pubfn:"",ds_button_pubfnData:"",ds_button_pubSaveExt:"",ds_button_pubSaveExt_callback:"",ds_button_pubAddExt_url:"",ds_button_pubAddExt_map:"",ds_button_pubAddExt_title:"表单标题",ds_button_pubAddExt_width:"80%",ds_button_pubAddExt_height:"70%",ds_button_pubAddExt_isTopwin:false,ds_button_pubUpdateExt_url:"",ds_button_pubUpdateExt_map:"",ds_button_pubUpdateExt_title:"表单标题",ds_button_pubUpdateExt_width:"80%",ds_button_pubUpdateExt_height:"70%",ds_button_pubUpdateExt_isTopwin:false,ds_button_pubDelExt_keyVal:"",ds_button_pubDelExt_control:"",ds_button_pubDelExt_delType:"",ds_button_pubDelExt_delCustom:"",ds_button_pubTableInsertExt:"",ds_button_pubTableDelExt:"",ds_button_pubTableSaveExt:"",ds_button_pubTableExportExt_fileName:"",ds_button_pubTableExportExt_fileType:"",ds_button_pubTableExportExt_isNotStyle:false,ds_button_pubTableExportExt_title:"",ds_button_pubTableChoseExt:"",ds_button_pubCustomImportExcel_Type:"Js",ds_button_pubCustomImportExcel:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:读取到的Excel表数据,event:文件所有内容",ds_button_pubStepUpExt:"",ds_button_pubStepDownExt:"",ds_button_pubReportExportExcelExt_iframeName:"",ds_load_success:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_button_click:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称}",ds_button_click_before:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称}",ds_button_click_after:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称}"}}function registerButton(){Vue.component("drag_button",{props:["type","info"],created:function(){this.$nextTick(function(){addListener(this);if(!this.info.ds_ispro)temporary.loadRegister[this.info.ds_id]=true;VUECFG.$refs[this.info.ds_id]=this})},data:function(){return{hide:"y-hide",refdate:Date.parse(new Date),mouseIn:false}},computed:{computed_drag:function(){if(VUECFG.viewStatu)return false;return this.info.ds_draggable},computed_flex:function(){var t={display:"flex",webkitDisplay:"flex",height:"100%",justifyContent:this.info.ds_button_horizontally,alignItems:this.info.ds_button_vertically};return t},computed_show:function(){var refdateStr=`${this.refdate}_change`;if(!VUECFG.viewStatu){return this.info.ds_ispro&&!this.info.ds_show?"y-hide":"y-show"}else{if(this.info.ds_showCondition){var str=$DS.util.replace(this.info.ds_showCondition);return eval(str)?"y-show":"y-hide"}return this.info.ds_show?"y-show":"y-hide"}},computed_marginleft:function(){if(this.info.ds_labelwidth=="0"){return{marginLeft:"1rem"}}return{marginLeft:this.info.ds_showlable?this.info.ds_labelwidth+"rem":"0rem"}},computed_isrequired:function(){return this.info.ds_isrequired?"ds_isrequired":""},computed_outerstyle:function(){var t=0;if(this.info.ds_labelwidth=="0"){t="calc("+this.info.ds_innerwidth+" - 1rem)"}else{t=this.info.ds_showlable?"calc("+this.info.ds_innerwidth+" - "+this.info.ds_labelwidth+"rem)":this.info.ds_innerwidth}var e={width:t,zIndex:this.info.ds_button_zIndex,margin:this.info.ds_out_margin};return e},computed_style:function(){return{padding:this.info.ds_in_padding,height:this.info.ds_button_height,backgroundColor:this.mouseIn&&this.info.ds_button_background_hover_color?this.info.ds_button_background_hover_color:this.info.ds_button_background_color,fontSize:this.info.ds_button_fontsize,fontWeight:this.info.ds_button_fontweight,fontFamily:this.info.ds_button_fontfamily,color:this.mouseIn&&this.info.ds_button_hover_color?this.info.ds_button_hover_color:this.info.ds_button_color,borderWidth:this.info.ds_button_borderwidth,borderColor:this.info.ds_button_bordercolor,borderStyle:this.info.ds_button_borderstyle}},computed_labelstyle:function(){return{width:this.info.ds_labelwidth+"rem",color:this.info.ds_labelcolor,fontWeight:!this.info.ds_ispro?this.info.ds_labelfontweight:"normal",fontFamily:this.info.ds_labelfontfamily,fontSize:this.info.ds_labelfontsize}}},methods:{changeCurrId:changeCurrId,mouseOver:ctrlMouseOver,mouseLeave:ctrlMouseLeave,buttonClick:buttonClick,readFile:readFileForCustomImport,buttonMouseover(){this.mouseIn=true},buttonMouseLeave(){this.mouseIn=false}},template:util.getModelHtml("drag_button")})}function readFileForCustomImport(t){debugger;var e=this.info;if(e.ds_button_pubfn!=="CustomImportExcel"){return}const s=t.target.files;if(e.ds_button_pubCustomImportExcel_Type=="Java"){var d=new FormData;d.append("file",s[0]);var _=$DS.util.getProjectName(VUECFG.appId);$.ajax({url:_+"/sysconfig/frame/analysisExcel",type:"post",data:d,contentType:false,processData:false,cache:false,success:function(s){$DS.eval(e.ds_button_pubCustomImportExcel,e,s.result,t);$("#"+e.ds_id).find(".button_fileUploader")[0].value=null},error:function(t){console.error("解析Excel失败!");$("#"+e.ds_id).find(".button_fileUploader")[0].value=null}})}else{if(s.length<=0){return false}else if(!/\.(xls|xlsx)$/.test(s[0].name.toLowerCase())){alert("文件传格式不正确");return false}if(s.length<=0){return false}else if(!/\.(xls|xlsx)$/.test(s[0].name.toLowerCase())){alert("文件传格式不正确");return false}const d=new FileReader;d.onload=(s=>{try{const _=s.target.result;const l=XLSX.read(_,{type:"binary"});var d=[];for(let t=0;t<l.SheetNames.length;t++){const e=l.SheetNames[t];const s=XLSX.utils.sheet_to_row_object_array(l.Sheets[e]);d.push(s)}console.log(d);$DS.eval(e.ds_button_pubCustomImportExcel,e,d,t);$("#"+e.ds_id).find(".button_fileUploader")[0].value=null}catch(t){console.error(t);$("#"+e.ds_id).find(".button_fileUploader")[0].value=null;return false}});d.readAsBinaryString(s[0])}}function loadSuccess(t,e){var s=this.info;$DS.eval(s.ds_load_success,s)}function buttonClick(){debugger;if(!VUECFG.viewStatu&&!this.info.ds_ispro)return;var t=true;t=$DS.eval(this.info.ds_button_click_before,this.info,null);if(!t)return false;t=$DS.eval(this.info.ds_button_click,this.info,null);t=executePubFn(this.info,this);if(!t)return false;if(this.info.ds_datasource){var e=$DS.getSourceById(this.info.ds_datasource);if(s){var s=e.sourceData;if(s&&s[this.info.ds_name]){$DS.dealPms(this.info,s[this.info.ds_name])}}}if(this.info.ds_trigger&&this.info.ds_trigger.length>0){triggerComps(this.info.ds_trigger,$DS.getCtrlType(this.info.ds_id))}t=$DS.eval(this.info.ds_button_click_after,this.info,null);if(!t)return false}function showPropertyButton(t){var e=[];var s=getProInfoByObj("select",{ds_id:"type",ds_pid:VUECFG.ctrlId,ds_labeltxt:"组件类型",ds_placeholder:"组件类型",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:true,ds_options:getAllCtrl(),ds_select:$button.type,ds_select_change:"changeFormCtrl",ds_name:"type",ds_ispro:true});e.push(s);var d=getProInfoByObj("input",{ds_id:"ds_ctrlname",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件名",ds_placeholder:"控件名",ds_input:VUECFG.formObj[VUECFG.ctrlId].info.ds_ctrlname,ds_input_blur:"checkDuplication",ds_name:"ds_ctrlname",ds_ispro:true,ds_drag:false});e.push(d);var _=getProInfoByObj("input",{ds_id:"ds_button",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"按钮名称",ds_placeholder:"按钮名称",ds_input:"按钮",ds_name:"ds_button",ds_ispro:true});e.push(_);var l=getProInfoByObj("input",{ds_id:"ds_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件宽度",ds_placeholder:"控件宽度",ds_input:"100%",ds_name:"ds_width",ds_ispro:true,ds_isrequired:false,group1:"",group2:""});e.push(l);var r=getProInfoByObj("input",{ds_id:"ds_height",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件高度",ds_placeholder:"控件高度",ds_input:"5rem",ds_name:"ds_height",ds_ispro:true});e.push(r);var o=getProInfoByObj("input",{ds_id:"ds_labeltxt",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"标题",ds_placeholder:"标题",ds_input:"按钮",ds_name:"ds_labeltxt",ds_show:false,ds_ispro:true});e.push(o);var a=getProInfoByObj("select",{ds_id:"ds_datasource",ds_pid:VUECFG.ctrlId,ds_labeltxt:"数据源",ds_placeholder:"数据源",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasource(),ds_select:"",ds_select_change:"changeDataSourceForCtrl",ds_select_visible_change:"changeDatasourceOption",ds_name:"ds_datasource",ds_ispro:true,group1:"数据源",group2:""});e.push(a);var u=getProInfoByObj("select",{ds_id:"ds_name",ds_pid:VUECFG.ctrlId,ds_labeltxt:"字段名",ds_placeholder:"字段名",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasourceField(),ds_select:"",ds_select_change:"changeFieldNameForCtrl",ds_select_visible_change:"changeFieldOption",ds_name:"ds_name",ds_ispro:true,group1:"数据源",group2:""});e.push(u);var i=getProInfoByObj("input",{ds_id:"ds_labelwidth",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"标签宽度",ds_placeholder:"标签宽度",ds_input:"10",ds_name:"ds_labelwidth",ds_ispro:true,ds_show:false,ds_append:"rem"});e.push(i);var n=getProInfoByObj("color",{ds_id:"ds_labelcolor",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"标签颜色",ds_name:"ds_labelcolor",ds_ispro:true,ds_show_alpha:true,ds_color:"#606266",ds_show:false,group1:"属性",group2:"组件布局"});e.push(n);var p=getProInfoByObj("select",{ds_id:"ds_labelfontweight",ds_pid:VUECFG.ctrlId,ds_labeltxt:"标签字体加粗",ds_placeholder:"标签字体加粗",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getFontWeight(),ds_select:"bold",ds_name:"ds_labelfontweight",ds_ispro:true,ds_show:false,group1:"属性",group2:"组件布局"});e.push(p);var b=getProInfoByObj("select",{ds_id:"ds_labelfontfamily",ds_pid:VUECFG.ctrlId,ds_labeltxt:"标签字体样式",ds_placeholder:"标签字体样式",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getFontFamily(),ds_select:"微软雅黑",ds_name:"ds_labelfontfamily",ds_ispro:true,ds_show:false,group1:"属性",group2:"组件布局"});e.push(b);var f=getProInfoByObj("input",{ds_id:"ds_labelfontsize",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"标签字体大小",ds_placeholder:"标签字体大小",ds_input:"1rem",ds_name:"ds_labelfontsize",ds_ispro:true,ds_isrequired:false,ds_show:false,group1:"属性",group2:"组件布局"});e.push(f);var g=getProInfoByObj("input",{ds_id:"ds_innerwidth",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"组件宽度",ds_placeholder:"组件宽度",ds_input:"calc(100% - 0rem)",ds_name:"ds_innerwidth",ds_ispro:true,group1:"属性",group2:"组件布局"});e.push(g);var c=getProInfoByObj("select",{ds_id:"ds_button_horizontally",ds_pid:VUECFG.ctrlId,ds_labeltxt:"内部水平排列",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"flex-start",label:"左对齐"},{value:"flex-end",label:"右对齐"},{value:"center",label:"居中"}],ds_select:"center",ds_name:"ds_button_horizontally",ds_ispro:true,ds_show:true,group1:"属性",group2:"组件布局"});e.push(c);var h=getProInfoByObj("select",{ds_id:"ds_button_vertically",ds_pid:VUECFG.ctrlId,ds_labeltxt:"内部垂直排列",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"flex-start",label:"置顶"},{value:"flex-end",label:"置底"},{value:"center",label:"居中"}],ds_select:"center",ds_name:"ds_button_vertically",ds_ispro:true,ds_show:true,group1:"属性",group2:"组件布局"});e.push(h);var m=getProInfoByObj("input",{ds_id:"ds_in_padding",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"内边距大小",ds_placeholder:"内边距大小",ds_input:"0.5rem 1rem",ds_name:"ds_in_padding",ds_ispro:true,group1:"属性",group2:"组件布局"});e.push(m);var E=getProInfoByObj("input",{ds_id:"ds_out_margin",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"外边距大小",ds_placeholder:"外边距大小",ds_input:"0rem",ds_name:"ds_out_margin",ds_ispro:true,group1:"属性",group2:"组件布局"});e.push(E);var x=getProInfoByObj("input",{ds_id:"ds_button_zIndex",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件z-index",ds_placeholder:"控件z-index",ds_input:"1999",ds_name:"ds_button_zIndex",ds_ispro:true,ds_valformat:"NUMBER",group1:"属性",group2:"组件布局"});e.push(x);var v=getProInfoByObj("input",{ds_id:"ds_icon",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"图标类名",ds_placeholder:"请输入图标类名",ds_input:"el-icon-search",ds_append:"选择",ds_input_appendclick:"clickChooseIcon",ds_name:"ds_icon",ds_ispro:true,group1:"属性",group2:"组件样式"});e.push(v);var y=getProInfoByObj("color",{ds_id:"ds_button_background_color",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"按钮背景颜色",ds_name:"ds_button_background_color",ds_ispro:true,ds_show_alpha:true,ds_color:"rgb(64, 158, 255)",group1:"属性",group2:"组件样式"});e.push(y);var I=getProInfoByObj("color",{ds_id:"ds_button_background_hover_color",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"鼠标悬浮背景颜色",ds_name:"ds_button_background_hover_color",ds_ispro:true,ds_show_alpha:true,ds_color:"",group1:"属性",group2:"组件样式"});e.push(I);var C=getProInfoByObj("input",{ds_id:"ds_button_height",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"按钮高度",ds_placeholder:"",ds_input:"100%",ds_name:"ds_button_height",ds_ispro:true,group1:"属性",group2:"组件样式"});e.push(C);var w=getProInfoByObj("select",{ds_id:"ds_type",ds_pid:VUECFG.ctrlId,ds_labeltxt:"按钮类型",ds_placeholder:"按钮类型",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"",label:"default"},{value:"primary",label:"primary"},{value:"success",label:"success"},{value:"warning",label:"warning"},{value:"danger",label:"danger"},{value:"info",label:"info"},{value:"text",label:"text"}],ds_select:"primary",ds_name:"ds_type",ds_ispro:true,group1:"属性",group2:"组件样式"});e.push(w);var D=getProInfoByObj("radio",{ds_id:"ds_size",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"按钮尺寸",ds_name:"ds_size",ds_radio:"medium",ds_options:[{value:"medium",text:"中等"},{value:"small",text:"较小"},{value:"mini",text:"迷你"}],ds_radiobtn:true,ds_ispro:true,group1:"属性",group2:"组件样式"});e.push(D);var S=getProInfoByObj("switch",{ds_id:"ds_plain",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否朴素按钮",ds_name:"ds_plain",ds_switch:false,ds_ispro:true,group1:"属性",group2:"组件样式"});e.push(S);var F=getProInfoByObj("switch",{ds_id:"ds_round",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"圆角按钮",ds_name:"ds_round",ds_switch:false,ds_ispro:true,group1:"属性",group2:"组件样式"});e.push(F);var U=getProInfoByObj("switch",{ds_id:"ds_circle",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"圆形按钮",ds_name:"ds_circle",ds_switch:false,ds_ispro:true,group1:"属性",group2:"组件样式"});e.push(U);var j=getProInfoByObj("select",{ds_id:"ds_button_fontfamily",ds_pid:VUECFG.ctrlId,ds_labeltxt:"按钮字体样式",ds_placeholder:"按钮字体样式",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getFontFamily(),ds_select:"微软雅黑",ds_name:"ds_button_fontfamily",ds_ispro:true,group1:"属性",group2:"组件字体"});e.push(j);var B=getProInfoByObj("color",{ds_id:"ds_button_color",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"按钮字体颜色",ds_name:"ds_button_color",ds_ispro:true,ds_show_alpha:true,ds_color:"#FFF",group1:"属性",group2:"组件字体"});e.push(B);var V=getProInfoByObj("color",{ds_id:"ds_button_hover_color",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"鼠标悬浮字体颜色",ds_name:"ds_button_hover_color",ds_ispro:true,ds_show_alpha:true,ds_color:"",group1:"属性",group2:"组件字体"});e.push(V);var P=getProInfoByObj("input",{ds_id:"ds_button_fontsize",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"按钮字体大小",ds_placeholder:"",ds_input:"1rem",ds_name:"ds_button_fontsize",ds_ispro:true,group1:"属性",group2:"组件字体"});e.push(P);var T=getProInfoByObj("select",{ds_id:"ds_button_fontweight",ds_pid:VUECFG.ctrlId,ds_labeltxt:"按钮字体粗细",ds_placeholder:"按钮字体粗细",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getFontWeight(),ds_select:"normal",ds_name:"ds_button_fontweight",ds_ispro:true,group1:"属性",group2:"组件字体"});e.push(T);var G=getProInfoByObj("input",{ds_id:"ds_button_borderwidth",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"边框宽度",ds_placeholder:"",ds_input:"0rem",ds_name:"ds_button_borderwidth",ds_ispro:true,group1:"属性",group2:"按钮边框"});e.push(G);var O=getProInfoByObj("radio",{ds_id:"ds_button_borderstyle",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"边框类型",ds_name:"ds_button_borderstyle",ds_radio:"solid",ds_options:[{value:"dashed",text:"虚线"},{value:"solid",text:"实线"},{value:"dotted",text:"点"}],ds_radiobtn:true,ds_ispro:true,group1:"属性",group2:"按钮边框"});e.push(O);var A=getProInfoByObj("color",{ds_id:"ds_button_bordercolor",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"边框颜色",ds_name:"ds_button_bordercolor",ds_ispro:true,ds_show_alpha:true,ds_color:"#CCC",group1:"属性",group2:"按钮边框"});e.push(A);var k=getProInfoByObj("select",{ds_id:"ds_button_pubfn",ds_pid:VUECFG.ctrlId,ds_labeltxt:"按钮通用功能",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"none",label:"无"},{value:"Close",label:"关闭弹窗"},{value:"Save",label:"保存"},{value:"Add",label:"新增"},{value:"Update",label:"修改"},{value:"Del",label:"删除"},{value:"TableInsert",label:"表格插入行"},{value:"TableDel",label:"表格删除行"},{value:"TableSave",label:"保存表格"},{value:"StepUp",label:"步骤条上一步"},{value:"StepDown",label:"步骤条下一步"},{value:"TableExport",label:"导出表格"},{value:"ReportExportExcel",label:"导出报表表格"},{value:"ReportPrintExcel",label:"打印报表表格"},{value:"ExcelImport",label:"导入数据"},{value:"CustomImportExcel",label:"自定义导入Excel数据"}],ds_name:"ds_button_pubfn",ds_ispro:true,ds_show:true,ds_select:"none",ds_select_change:"changePubFn",group1:"属性",group2:"按钮功能"});e.push(k);var N=getProInfoByObj("input",{ds_id:"ds_button_pubSaveExt",ds_pid:VUECFG.ctrlId,ds_labeltxt:"保存的数据源",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubSaveExt",ds_ispro:true,ds_show:false,ds_input_focus:"setSaveData",ds_readonly:true,group1:"属性",group2:"按钮功能"});e.push(N);var R=getProInfoByObj("jseditor",{ds_id:"ds_button_pubSaveExt_callback",ds_pid:VUECFG.ctrlId,ds_labeltxt:"保存成功事件",ds_placeholder:"脚本编辑",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"",ds_prepend:"fn(obj,val){",ds_jseditor_change:"",ds_name:"ds_button_pubSaveExt_callback",ds_ispro:true,ds_savedb:false,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(R);var L=getProInfoByObj("input",{ds_id:"ds_button_pubAddExt_url",ds_pid:VUECFG.ctrlId,ds_labeltxt:"打开的表单url",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubAddExt_url",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(L);var z=getProInfoByObj("input",{ds_id:"ds_button_pubAddExt_title",ds_pid:VUECFG.ctrlId,ds_labeltxt:"打开的表单标题",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubAddExt_title",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(z);var M=getProInfoByObj("input",{ds_id:"ds_button_pubAddExt_width",ds_pid:VUECFG.ctrlId,ds_labeltxt:"表单宽度",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubAddExt_width",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(M);var J=getProInfoByObj("input",{ds_id:"ds_button_pubAddExt_height",ds_pid:VUECFG.ctrlId,ds_labeltxt:"表单高度",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubAddExt_height",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(J);var q=getProInfoByObj("input",{ds_id:"ds_button_pubAddExt_map",ds_pid:VUECFG.ctrlId,ds_labeltxt:"传递的数据",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubAddExt_map",ds_ispro:true,ds_show:false,ds_input_focus:"setPubAddEditData",ds_valformat:"JSON",ds_readonly:true,group1:"属性",group2:"按钮功能"});e.push(q);var W=getProInfoByObj("switch",{ds_id:"ds_button_pubAddExt_isTopwin",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否弹出到顶层窗口",ds_name:"ds_button_pubAddExt_isTopwin",ds_switch:false,ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(W);var H=getProInfoByObj("input",{ds_id:"ds_button_pubUpdateExt_url",ds_pid:VUECFG.ctrlId,ds_labeltxt:"打开的表单url",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubUpdateExt_url",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(H);var X=getProInfoByObj("input",{ds_id:"ds_button_pubUpdateExt_title",ds_pid:VUECFG.ctrlId,ds_labeltxt:"打开的表单标题",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubUpdateExt_title",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(X);var K=getProInfoByObj("input",{ds_id:"ds_button_pubUpdateExt_width",ds_pid:VUECFG.ctrlId,ds_labeltxt:"表单宽度",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubUpdateExt_width",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(K);var Y=getProInfoByObj("input",{ds_id:"ds_button_pubUpdateExt_height",ds_pid:VUECFG.ctrlId,ds_labeltxt:"表单高度",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubUpdateExt_height",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(Y);var Q=getProInfoByObj("input",{ds_id:"ds_button_pubUpdateExt_map",ds_pid:VUECFG.ctrlId,ds_labeltxt:"传递的数据",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubUpdateExt_map",ds_ispro:true,ds_show:false,ds_input_focus:"setPubAddEditData",ds_valformat:"JSON",ds_readonly:true,group1:"属性",group2:"按钮功能"});e.push(Q);var Z=getProInfoByObj("switch",{ds_id:"ds_button_pubUpdateExt_isTopwin",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否弹出到顶层窗口",ds_name:"ds_button_pubUpdateExt_isTopwin",ds_switch:false,ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(Z);var tt=getProInfoByObj("select",{ds_id:"ds_button_pubDelExt_control",ds_pid:VUECFG.ctrlId,ds_labeltxt:"关联控件",ds_placeholder:"请选择控件",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[],ds_select_visible_change:"getAllTBCtrl",ds_select:"",ds_name:"ds_button_pubDelExt_control",ds_ispro:true,ds_multiple:false,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(tt);var et=getProInfoByObj("input",{ds_id:"ds_button_pubDelExt_keyVal",ds_pid:VUECFG.ctrlId,ds_labeltxt:"主键值",ds_placeholder:'表达式: ${V.a.b,"默认值"} ',ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubDelExt_keyVal",ds_ispro:true,ds_show:false,ds_valformat:"STRING",group1:"属性",group2:"按钮功能"});e.push(et);var st=getProInfoByObj("radio",{ds_id:"ds_button_pubDelExt_delType",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"删除方式",ds_name:"ds_button_pubDelExt_delType",ds_radio:false,ds_options:[{value:false,text:"默认"},{value:true,text:"级联删除"}],ds_radiobtn:true,ds_ispro:true,ds_show:false,ds_radio_change:"changeDelType",group1:"属性",group2:"按钮功能"});e.push(st);var dt=getProInfoByObj("input",{ds_id:"ds_button_pubDelExt_delCustom",ds_pid:VUECFG.ctrlId,ds_labeltxt:"级联删除设置",ds_placeholder:"T1:F1,T2:F2",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubDelExt_delCustom",ds_ispro:true,ds_show:false,ds_valformat:"JSON",ds_input_focus:"setDelCustom",ds_readonly:true,group1:"属性",group2:"按钮功能"});e.push(dt);var _t=getProInfoByObj("select",{ds_id:"ds_button_pubTableChoseExt",ds_pid:VUECFG.ctrlId,ds_labeltxt:"进行操作的表格",ds_placeholder:"进行操作的表格",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[],ds_select_visible_change:"getAllTBCtrl",ds_select:"",ds_name:"ds_button_pubTableChoseExt",ds_ispro:true,ds_multiple:false,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(_t);var lt=getProInfoByObj("input",{ds_id:"ds_button_pubTableExportExt_fileName",ds_pid:VUECFG.ctrlId,ds_labeltxt:"导出文件文件名称",ds_placeholder:"默认为控件名称",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubTableExportExt_fileName",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(lt);var rt=getProInfoByObj("select",{ds_id:"ds_button_pubTableExportExt_fileType",ds_pid:VUECFG.ctrlId,ds_labeltxt:"导出的文件格式",ds_placeholder:"默认为 xlsx ",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[{value:"xlsx",label:"xlsx"},{value:"xls",label:"xls"}],ds_select:"xlsx",ds_name:"ds_button_pubTableExportExt_fileType",ds_ispro:true,ds_multiple:false,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(rt);var ot=getProInfoByObj("input",{ds_id:"ds_button_pubTableExportExt_title",ds_pid:VUECFG.ctrlId,ds_labeltxt:"导出的文件表头",ds_placeholder:"非必填",ds_style:"ds-mt-1",ds_draggable:"false",ds_name:"ds_button_pubTableExportExt_title",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(ot);var at=getProInfoByObj("switch",{ds_id:"ds_button_pubTableExportExt_isNotStyle",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否携带样式",ds_name:"ds_button_pubTableExportExt_isNotStyle",ds_switch:false,ds_active_value:true,ds_inactive_value:false,ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(at);var ut=getProInfoByObj("radio",{ds_id:"ds_button_pubCustomImportExcel_Type",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"解析excel方式",ds_name:"ds_button_pubCustomImportExcel_Type",ds_radio:"Js",ds_options:[{value:"Js",text:"前台解析"},{value:"Java",text:"后台解析"}],ds_radiobtn:true,ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(ut);var it=getProInfoByObj("jseditor",{ds_id:"ds_button_pubCustomImportExcel",ds_pid:VUECFG.ctrlId,ds_labeltxt:"自定义导入Excel数据",ds_placeholder:"脚本编辑",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:读取到的Excel表数据,event:文件所有内容",ds_prepend:"fn(obj,val){",ds_jseditor_change:"",ds_name:"ds_button_pubCustomImportExcel",ds_ispro:true,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(it);var nt=getProInfoByObj("select",{ds_id:"ds_button_pubReportExportExcelExt_iframeName",ds_pid:VUECFG.ctrlId,ds_labeltxt:"选择网页框控件",ds_placeholder:"选择网页框控件 ",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[],ds_select_visible_change:"getAllTBCtrl",ds_name:"ds_button_pubReportExportExcelExt_iframeName",ds_ispro:true,ds_multiple:false,ds_show:false,group1:"属性",group2:"按钮功能"});e.push(nt);var pt=getProInfoByObj("switch",{ds_id:"ds_disabled",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否禁用",ds_name:"ds_disabled",ds_switch:false,ds_ispro:true,group1:"属性",group2:"组件属性"});e.push(pt);var bt=getProInfoByObj("switch",{ds_id:"ds_isrequired",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否必填",ds_name:"ds_isrequired",ds_switch:false,ds_ispro:true,group1:"属性",group2:"组件属性"});e.push(bt);var ft=getProInfoByObj("input",{ds_id:"ds_param",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"推送参数名",ds_placeholder:"控件推送参数名",ds_input:"",ds_name:"ds_param",ds_ispro:true,group1:"参数推送",group2:""});e.push(ft);var gt=getProInfoByObj("input",{ds_id:"ds_backParamCondition",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"撤销推送条件",ds_placeholder:"推送参数名.A=='a'||推送参数名.A=='b'",ds_input:"",ds_name:"ds_backParamCondition",ds_ispro:true,group1:"参数推送",group2:""});e.push(gt);var ct=getProInfoByObj("select",{ds_id:"ds_trigger",ds_pid:VUECFG.ctrlId,ds_labeltxt:"触发刷新控件",ds_placeholder:"请选择触发刷新控件",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[],ds_select_visible_change:"getAllPageCtrl",ds_select:"",ds_name:"ds_trigger",ds_ispro:true,ds_multiple:true,group1:"控件加载",group2:""});e.push(ct);var ht=getProInfoByObj("select",{ds_id:"ds_loading",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载机制",ds_placeholder:"请选择加载机制",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"first",label:"优先加载"},{value:"normal",label:"正常加载"},{value:"lazy",label:"懒加载"}],ds_select:"normal",ds_select_change:"changeCtrlLoading",ds_name:"ds_loading",ds_ispro:true,group1:"控件加载",group2:""});e.push(ht);var mt=getProInfoByObj("switch",{ds_id:"ds_show",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示控件",ds_name:"ds_show",ds_switch:true,ds_ispro:true,group1:"显示设置",group2:""});e.push(mt);var Et=getProInfoByObj("input",{ds_id:"ds_showCondition",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示条件",ds_placeholder:"${V.推送参数名.A}=='a'||${V.推送参数名.A}=='b'",ds_input:"",ds_name:"ds_showCondition",ds_ispro:true,group1:"显示设置",group2:""});e.push(Et);var xt=getProInfoByObj("switch",{ds_id:"ds_showlable",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示标题",ds_name:"ds_showlable",ds_switch:false,ds_switch_change:"showLableForBtn",ds_ispro:true,ds_show:false,group1:"显示设置",group2:""});e.push(xt);var vt=getProInfoByObj("jseditor",{ds_id:"ds_load_success",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载完成事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_load_success",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(vt);var yt=getProInfoByObj("jseditor",{ds_id:"ds_button_click_before",ds_pid:VUECFG.ctrlId,ds_labeltxt:"点击前事件",ds_placeholder:"脚本编辑",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称}",ds_prepend:"fn(obj){",ds_jseditor_change:"",ds_name:"ds_button_click_before",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(yt);var It=getProInfoByObj("jseditor",{ds_id:"ds_button_click",ds_pid:VUECFG.ctrlId,ds_labeltxt:"点击事件",ds_placeholder:"脚本编辑",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称}",ds_prepend:"fn(obj){",ds_jseditor_change:"",ds_name:"ds_button_click",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(It);var Ct=getProInfoByObj("jseditor",{ds_id:"ds_button_click_after",ds_pid:VUECFG.ctrlId,ds_labeltxt:"点击后事件",ds_placeholder:"脚本编辑",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称}",ds_prepend:"fn(obj){",ds_jseditor_change:"",ds_name:"ds_button_click_after",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(Ct);if(VUECFG.proObj[VUECFG.ctrlId]&&!t){var wt=VUECFG.proObj[VUECFG.ctrlId];for(var Dt=0;Dt<e.length;Dt++){for(var St=0;St<wt.length;St++){if(e[Dt].info.ds_name==wt[St].info.ds_name){var s=e[Dt].type.split("drag_")[1];e[Dt].info["ds_"+s]=wt[St].info["ds_"+s];if(!$DS.util.isUndefined(wt[St].info["ds_show"]))e[Dt].info["ds_show"]=wt[St].info["ds_show"]}}}}VUECFG.proObj[VUECFG.ctrlId]=[];VUECFG.proArr=formatterCtrlProCfg(e);VUECFG.proObj[VUECFG.ctrlId]=e;$("#templetePro").click()}function changePubFn(t,e){debugger;var s=$DS.getCtrlById(t.ds_pid).info;var d=["ds_button_pubSaveExt","ds_button_pubSaveExt_callback","ds_button_pubAddExt_url","ds_button_pubAddExt_map","ds_button_pubAddExt_title","ds_button_pubAddExt_width","ds_button_pubAddExt_height","ds_button_pubAddExt_isTopwin","ds_button_pubUpdateExt_url","ds_button_pubUpdateExt_map","ds_button_pubUpdateExt_title","ds_button_pubUpdateExt_width","ds_button_pubUpdateExt_height","ds_button_pubUpdateExt_isTopwin","ds_button_pubDelExt_keyVal","ds_button_pubDelExt_control","ds_button_pubDelExt_delType","ds_button_pubDelExt_delCustom","ds_button_pubTableInsertExt","ds_button_pubTableDelExt","ds_button_pubTableSaveExt","ds_button_pubTableExportExt_isNotStyle","ds_button_pubTableExportExt_fileName","ds_button_pubTableExportExt_fileType","ds_button_pubTableExportExt_title","ds_button_pubReportExportExcelExt_iframeName"];var _=t.ds_pid;if(e.indexOf("Table")!==-1){$DS.setRightProShow(_,{ds_button_pubTableChoseExt:true})}else{$DS.setRightProShow(_,{ds_button_pubTableChoseExt:false})}for(let t=0;t<d.length;t++){var l={};if(d[t].indexOf("pub"+e+"Ext")!==-1){l[d[t]]=true}else{l[d[t]]=false}$DS.setRightProShow(_,l)}if(e.indexOf("Del")!==-1){$DS.setRightProShow(_,{ds_button_pubDelExt_delCustom:t.ds_button_pubDelExt_delType})}if(e=="ReportPrintExcel"){$DS.setRightProShow(_,{ds_button_pubReportExportExcelExt_iframeName:true})}if(e=="CustomImportExcel"){$DS.setRightProShow(_,{ds_button_pubCustomImportExcel:true,ds_button_pubCustomImportExcel_Type:true})}else{$DS.setRightProShow(_,{ds_button_pubCustomImportExcel:false,ds_button_pubCustomImportExcel_Type:false})}}function setSaveData(t){if(VUECFG.sourceArr.length<=0){console.log("请先设置数据源!");return}var e=[{field:"name",title:"数据源名称",width:1}];var s=[];var d=[];var _=$DS.getCtrlById(t.ds_pid).info;for(let t=0;t<VUECFG.sourceArr.length;t++){var l={};l["name"]=VUECFG.sourceArr[t].sourceName;s.push(l)}if(_.ds_button_pubfnData){if(typeof _.ds_button_pubfnData==="string"){d=JSON.parse(_.ds_button_pubfnData)}else{d=_.ds_button_pubfnData}for(let t=0;t<d.length;t++){var r=d[t].name;if(d[t].LAY_CHECKED===true){for(let e=0;e<s.length;e++){if(s[e].name===r){s[e]=d[t]}}}}}$DS.openCfgTable(e,s,function(e,s){_.ds_button_pubfnData=e;e=JSON.parse(e);var d="";for(let t=0;t<e.length;t++){if(e[t].LAY_CHECKED===true){if(t!==e.length-1){d+=e[t].name+","}else{d+=e[t].name}}}t.ds_input=d},"50%","80%","选择要保存的数据源")}function setPubAddEditData(t){var e=[{field:"key",title:"参数名",width:.2,edit:"text"},{field:"value",title:'参数值( 表达式: ${V."参数名","默认值"} 。例如: ${V.aaa,"300"} )',width:.4,edit:"text"},{field:"tip",title:"空值提示",width:.4,edit:"text"}];var s=$DS.getCtrlById(t.ds_pid).info[t.ds_id];if(s&&typeof s==="string"){s=JSON.parse(s)}$DS.openCfgTable(e,s,function(e,s){if(typeof e!=="string"){e=JSON.stringify(e)}$DS.getCtrlById(t.ds_pid).info[t.ds_id]=e;t.ds_input=e},"80%","70%","配置参数")}function executePubFn(t,e){debugger;var s=t.ds_button_pubfn;var d=true;if(s){var _=null;if(s.indexOf("Table")!==-1){_=t.ds_button_pubTableChoseExt}switch(s){case"CustomImportExcel":$("#"+t.ds_id).find(".button_fileUploader").click();break;case"Close":$DS.util.close();break;case"Save":$DS.loadingFun("btnPubSave");btnPubSave(t);break;case"Add":d=btnPubAddEdit(t,"Add");break;case"Update":d=btnPubAddEdit(t,"Update");break;case"Del":d=btnPubDel(t,e);break;case"ExcelImport":d=btnPubExcelImport(t);break;case"TableInsert":$grid.insertRow(_);break;case"TableDel":$grid.deleteRow(_);break;case"TableSave":$grid.save(_);break;case"TableExport":d=btnPubExportExcel(t,_);break;case"StepUp":for(let e=0;e<t.ds_trigger.length;e++){if($DS.getCtrlType(t.ds_trigger[e])=="step"){$step.change($DS.getCtrlById(t.ds_trigger[e]).info,"sub")}}break;case"StepDown":for(let e=0;e<t.ds_trigger.length;e++){if($DS.getCtrlType(t.ds_trigger[e])=="step"){$step.change($DS.getCtrlById(t.ds_trigger[e]).info,"add")}}break;case"ReportExportExcel":var l=t.ds_button_pubReportExportExcelExt_iframeName;var r=$DS.getCtrlById(l).info.ds_ctrlname;$DS.util.exportReportExcel(r);break;case"ReportPrintExcel":var l=t.ds_button_pubReportExportExcelExt_iframeName;var r=$DS.getCtrlById(l).info.ds_ctrlname;$DS.util.printReportExcel(r);break}return d}return d}function btnPubSave(t){if(!t){return}var e=$DS.getPms("URL_$type");var s=t.ds_button_pubfnData;if(!s){alert("未设置需要保存的数据源");return}if(typeof s==="string"){s=JSON.parse(s)}if(s.length>0){for(let a=0;a<s.length;a++){if(s[a].name==""||!s[a].LAY_CHECKED){continue}var d=$DS.getSource(s[a].name);var _=d.sourceId;var l=getRowsBySourceId(_);if(!l){console.error("获取操作的行数据失败!");return false}if(l.inserted.length===0&&l.updated.length===0&&l.deleted.length===0){alert("数据未发生更改");return false}var r=null;if(d.sourceType=="singleData"){r=$DS.saveSource(e,s[a].name,null,null)}else if(d.sourceType=="allData"){r=$DS.saveGridSource(l,s[a].name,null)}else{r={isError:true,errMsg:"通用保存不支持层级数据源!"}}if(r.isError){alert(r.errMsg);return false}else{var o=$DS.eval(t.ds_button_pubSaveExt_callback,t,r);if(!o){return false}else{$DS.refForm();alert("保存成功!")}}}}else{alert("未设置需要保存的数据源");return false}return true}function getRowsBySourceId(t){for(let s in VUECFG.groupObj){if(VUECFG.groupObj[s]===t){var e=$DS.getCtrlType(s);if(e){if(e==="grid"){$grid.setEditRows(s);return $DS.getCtrlById(s).info.ds_editAllRows}}else{continue}}}}function btnPubAddEdit(t,e){var s=t["ds_button_pub"+e+"Ext_url"];var d=t["ds_button_pub"+e+"Ext_title"];var _=t["ds_button_pub"+e+"Ext_width"];var l=t["ds_button_pub"+e+"Ext_height"];var r=t["ds_button_pub"+e+"Ext_isTopwin"];if(!s){alert("未设置打开的 "+d+" 页面!");return false}s+=e.toLowerCase()=="add"?"&$type=add":"&$type=edit";var o=t["ds_button_pub"+e+"Ext_map"];if(o&&typeof o==="string"){o=JSON.parse(o)}if(!(Object.keys(o).length===0)){for(let t=0;t<o.length;t++){var a=$DS.util.replace(o[t].value);if(!a&&o[t].tip){alert(o[t].tip);return false}s+="&"+o[t].key+"="+a}}if(s[s.length-1]==="&"){s=s.substr(0,s.length-1)}$DS.showPage(s,d,_,l,"","",r?$DS.util.getTopWin("window"):window);return true}function btnPubDel(t,e){var s=confirmTip(t);if(s===false)return;$DS.util.confirm(e,s,function(t,e){try{var s=e.ds_button_pubDelExt_keyVal;var d=e.ds_button_pubDelExt_control;var _=getDelCustom(e);if(!_){return false}var l=$DS.deleteByCtrlId(d,s,function(t,e,s,d){},e,_.delRef,"删除失败!",_.tableName,_.keyField);if(l.isError){alert(l.errMsg);return false}var r=$DS.getCtrlById(d);var o=r.info.ds_datasource;var a=$DS.getSourceById(o);$DS.setSourceVal(a,d);alert("删除成功!")}catch(t){alert("删除失败!");console.error(t);return false}},"已取消删除",t)}function confirmTip(t){var e=t.ds_button_pubDelExt_keyVal;var s=t.ds_button_pubDelExt_control;if(!e){alert("该按钮设置为删除按钮但未设置主键值!");return false}if(!s){alert("该按钮设置为删除按钮但未设置操作的控件!");return false}var d=$DS.getCtrlType(s);var _="是否确认删除?";if(d==="tree"){_="当前操作将删除当前节点及下级,是否确认删除?"}return _}function getDelCustom(t){var e={};if(!t.ds_button_pubDelExt_delType){e["tableName"]=null;e["keyField"]=null;e["delRef"]=null;return e}else{if(t.ds_button_pubDelExt_delCustom){var s=t.ds_button_pubDelExt_delCustom;if($DS.util.isString(s)){s=JSON.parse(t.ds_button_pubDelExt_delCustom)}e["tableName"]=s[0].TABLENAME;e["keyField"]=s[0].FIELDNAME;e["delRef"]="";for(let t=0;t<s.length;t++){if(t===0){continue}if(t===s.length-1){e["delRef"]+=s[t].TABLENAME+":"+s[t].FIELDNAME}else{e["delRef"]+=s[t].TABLENAME+":"+s[t].FIELDNAME+","}}}else{alert("未配置自定义删除信息!");return false}}return e}function changeDelType(t,e){var s=t.ds_pid;$DS.setRightProShow(s,{ds_button_pubDelExt_delCustom:e})}function setDelCustom(t){var e=$DS.getCtrlById(t.ds_pid).info;var s=e.ds_button_pubDelExt_control;var d=$DS.getCtrlById(s);if(!d||!d.info.ds_datasource){console.error("设置级联删除请先设置关联控件!")}else{var _=$DS.getSourceById(d.info.ds_datasource);var l=_.appId?_.appId:VUECFG.appId;var r=t.ds_input;if(r&&$DS.util.isString(r)){r=JSON.parse(r)}else if(!r){r=[]}var o=VUECFG.appObj[l];var a=[{value:"none",name:"请选择"}];for(let t=0;t<o.length;t++){var u={};u["value"]=o[t].TABLE_NAME;u["name"]=o[t].TABLE_NAMECN;a.push(u)}var i=[{field:"TABLENAME",title:"表名",width:.5,codeType:"select",code:a},{field:"FIELDNAME",title:"字段名",width:.5,codeType:"select",code:[]}];var n={};n["selectChange"]=function(t,e,s,d){if($(e).attr("name")!=="FIELDNAME"){var _=$DS.selectFieldInfo(s,l,"查询字段信息异常");if(_.isError){alert(_.errMsg);return false}else{_=_.result;var r=[{name:"请选择",value:"none"}];var o="";for(let t=0;t<_.length;t++){var a={};a["name"]=_[t].FIELD_NAME;a["value"]=_[t].FIELD_NAME;r.push(a)}for(let t=0;t<r.length;t++){o+="<option value="+r[t].value+">"+r[t].name+"</option>"}var u=$(e).parent().parent().parent().find("select").eq(1);$(u).empty().append(o);if(d){var i=t.layui.table.cache.layTable;var n=$(u).attr("uuid");for(let t=0;t<i.length;t++){if(n===i[t]._UUID){i[t].FIELDNAME="";$(u).attr("value","")}}}}}};$DS.openCfgTable(i,r,function(s,d){if(!$DS.util.isString(s)){s=JSON.stringify(s)}e.ds_button_pubDelExt_delCustom=s;t.ds_input=s},"50%","80%","设置删除配置信息",n)}}function btnPubExcelImport(t){$DS.showPage(getProjectName()+"/freeForm/js/editor/excelAnalysis/excelImport.jsp?appId="+VUECFG.appId,"导入数据","80%","90%")}function btnPubExportExcel(t,e){debugger;var s=$DS.getCtrlById(e).info;var d=s.ds_ctrlname;var _=t.ds_button_pubTableExportExt_isNotStyle?t.ds_button_pubTableExportExt_isNotStyle:false;var l=t.ds_button_pubTableExportExt_fileName?t.ds_button_pubTableExportExt_fileName:d;var r=t.ds_button_pubTableExportExt_fileType?t.ds_button_pubTableExportExt_fileType:"xlsx";var o=t.ds_button_pubTableExportExt_title?t.ds_button_pubTableExportExt_title:"";$DS.util.exportExcel(d,l,r,_,o)}function getAllTBCtrl(t,e){var s=[{label:"无",value:""}];if(!e)return s;$("#dropArea .ds_ctrl").each(function(){var e=$DS.getCtrlById(this.id);var d=$DS.getCtrlType(this.id);if(t.ds_id==="ds_button_pubTableChoseExt"){if(this.id!=VUECFG.ctrlId&&d==="grid"){s.push({label:e.info.ds_ctrlname,value:this.id})}}else if(t.ds_id=="ds_button_pubStepChoseExt"){if(this.id!=VUECFG.ctrlId&&d==="setp"){s.push({label:e.info.ds_ctrlname,value:this.id})}}else if(t.ds_id=="ds_button_pubReportExportExcelExt_iframeName"){if(this.id!=VUECFG.ctrlId&&(d==="tabs"||d==="iframe")){s.push({label:e.info.ds_ctrlname,value:this.id})}}else{if(this.id!=VUECFG.ctrlId&&(d==="tree"||d==="grid")){s.push({label:e.info.ds_ctrlname,value:this.id})}}});t.ds_options=s}function showLableForBtn(t,e){$DS.setRightProShow(t.ds_pid,{ds_labeltxt:e})}function setBtnVal(t,e,s){var d=$DS.getCtrlById(t);var _=getSourceById(VUECFG.groupObj[t]);if(_){if(!e&&d.info.ds_name&&$DS.getSourceData(_,s)){e=$DS.getSourceData(_,s)[d.info.ds_name]}d.info.btnData=e}else{d.info.btnData=e?e:""}}function getBtnVal(t){var e=$DS.getCtrlById(t);if(!e)console.error("【ID为"+t+"】的控件不存在!");return e.info.ds_btn_data}function clearBtnVal(t){t.info.ds_btn_data=""}