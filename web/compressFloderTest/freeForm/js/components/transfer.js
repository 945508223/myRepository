var $transfer={type:"drag_transfer",dataType:"allData",uuid:Date.parse(new Date),getConfig:getTransferConfig,register:registerTransfer,showProperty:showPropertyTransfer,setData:setTransferData,getData:getTransferData,clearData:clearTransferVal,clearQuery:clearQuery};function getTransferConfig(){return{ds_id:"",ds_ctrlname:"TRANSFER_"+$transfer.uuid++,ds_show:true,ds_showCondition:"",ds_width:"100%",ds_height:"18rem",ds_style:"drawing-item",ds_loading:"normal",ds_trigger:"",ds_out_padding:"1rem",ds_ispro:false,ds_pid:"",ds_draggable:"true",ds_datasource:"",ds_param:"",ds_backParamCondition:"",ds_transfer:[],ds_transfer_data:[],ds_filterable:false,ds_filter_placeholder:"",ds_target_order:"original",ds_titles:["列表 1","列表 2"],ds_button_texts:[],ds_format_noChecked:"${total}",ds_format_hasChecked:"${checked}/${total}",ds_props_key:"",ds_props_label:"",ds_props_disabled:"",ds_left_default_checked:[],ds_right_default_checked:[],ds_left_panel_width:"20rem",ds_right_panel_width:"20rem",ds_load_success:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_filter_method:`var label=obj.ds_props_label?obj.ds_props_label:"label";\n         val.item[label].indexOf(val.query)>-1;\n        //obj:配置对象,//val:{query:搜索值,//item:每一项数据}`,ds_render_content:"//obj:配置对象,//val:{h, option}",ds_transfer_change:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:{val 当前值,direction 数据移动的方向（'left' / 'right'）,keyArr 发生移动的数据 key 数组}",ds_left_check_change:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:{selectKeyArr 当前被选中的元素的 key 数组,changeKeyArr 选中状态发生变化的元素的 key 数组}",ds_right_check_change:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:{selectKeyArr 当前被选中的元素的 key 数组,changeKeyArr 选中状态发生变化的元素的 key 数组}"}}function registerTransfer(){Vue.component("drag_transfer",{props:["type","info"],created:function(){this.$nextTick(function(){addListener(this);if(!this.info.ds_ispro)temporary.loadRegister[this.info.ds_id]=true;VUECFG.$refs[this.info.ds_id]=this})},data:function(){return{value:[],hide:"y-hide",refdate:Date.parse(new Date)}},computed:{computed_drag:function(){if(VUECFG.viewStatu)return false;return this.info.ds_draggable},computed_position:function(){var e={minHeight:this.info.ds_height,height:this.info.ds_height,width:this.info.ds_width};return e},computed_show:function(){var refdateStr=`${this.refdate}_change`;if(!VUECFG.viewStatu){return this.info.ds_ispro&&!this.info.ds_show?"y-hide":"y-show"}else{if(this.info.ds_showCondition){var str=$DS.util.replace(this.info.ds_showCondition);return eval(str)?"y-show":"y-hide"}return this.info.ds_show?"y-show":"y-hide"}},computed_transfer:function(){if(!VUECFG.viewStatu)return this.info.ds_ctrlname;return""},computed_Ts:function(){if(!VUECFG.viewStatu){return{height:"0rem"}}},computed_outerstyle:function(){return{padding:this.info.ds_out_padding,width:"100%"}},computed_format:function(){debugger;var e={noChecked:"{total}",hasChecked:"${checked}/${total}"};e.noChecked=this.info.ds_format_noChecked?this.info.ds_format_noChecked:"";e.hasChecked=this.info.ds_format_hasChecked?this.info.ds_format_hasChecked:"";return e},computed_data:function(){debugger;var e=this.info.ds_transfer_data.map((e,s)=>{var d=e[this.info.ds_props_key?this.info.ds_props_key:"key"];var t=e[this.info.ds_props_label?this.info.ds_props_label:"label"];var r=e[this.info.ds_props_disabled?this.info.ds_props_disabled:"disabled"];e.key=$DS.util.isUndefined(d)?s.toString():d;e.label=$DS.util.isUndefined(t)?"":t;e.disabled=$DS.util.isUndefined(r)?false:r;return e});return e},computed_val:{get:function(){debugger;return this.info.ds_transfer?this.info.ds_transfer:[]},set:function(e){debugger;this.info.ds_transfer=e?e:[]}},computed_left_panel_style:function(){debugger;var e=`${this.refdate}_change`;this.$nextTick(function(){debugger;$($(`#${this.info.ds_id}`).find(".el-transfer-panel")[0]).css("width",`${this.info.ds_left_panel_width}`)});return e},computed_right_panel_style:function(){debugger;var e=`${this.refdate}_change`;this.$nextTick(function(){debugger;$($(`#${this.info.ds_id}`).find(".el-transfer-panel")[1]).css("width",`${this.info.ds_right_panel_width}`)});return e}},methods:{changeCurrId:changeCurrId,mouseOver:ctrlMouseOver,mouseLeave:ctrlMouseLeave,renderTransferContent:renderTransferContent,filterMethod:filterMethod,change:transferChange,leftCheckChange:leftCheckChange,rightCheckChange:rightCheckChange},template:util.getModelHtml("drag_transfer")})}function transferChange(e,s,d){var t=this.info;var r={val:e,direction:s,moveArr:d};$DS.eval(t.ds_transfer_change,t,r);$DS.dealPms(t,r);if(t.ds_trigger&&t.ds_trigger.length>0){triggerComps(t.ds_trigger,$DS.getCtrlType(t.ds_id))}}function leftCheckChange(e,s){var d=this.info;var t={selectKeyArr:e,changeKeyArr:s};$DS.eval(d.ds_left_check_change,d,t)}function rightCheckChange(e,s){var d=this.info;var t={selectKeyArr:e,changeKeyArr:s};$DS.eval(d.ds_right_check_change,d,t)}function clearQuery(e,s){var d=$DS.getCtrl(e).info.ds_id;VUECFG.$refs[d].clearQuery(s)}function filterMethod(e,s){debugger;var d=this.info;var t={query:e,item:s};return $DS.eval(d.ds_filter_method,d,t)}function renderTransferContent(h,option){var info=this.info;var params={h:h,option:option};var renderDom=$DS.eval(info.ds_render_content,info,params);if($DS.util.isString(renderDom))return eval(renderDom);return h("span",{domProps:{innerHTML:option[this.info.ds_props_label?this.info.ds_props_label:"label"]}})}function showPropertyTransfer(e){var s=[];var d=getProInfoByObj("select",{ds_id:"type",ds_pid:VUECFG.ctrlId,ds_labeltxt:"组件类型",ds_placeholder:"组件类型",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:true,ds_options:getAllCtrl(),ds_select:$transfer.type,ds_select_change:"changeFormCtrl",ds_name:"type",ds_ispro:true});s.push(d);var t=getProInfoByObj("input",{ds_id:"ds_ctrlname",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件名",ds_placeholder:"控件名",ds_input:VUECFG.formObj[VUECFG.ctrlId].info.ds_ctrlname,ds_input_blur:"checkDuplication",ds_name:"ds_ctrlname",ds_ispro:true});s.push(t);var r=getProInfoByObj("input",{ds_id:"ds_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件宽度",ds_placeholder:"控件宽度",ds_input:"100%",ds_name:"ds_width",ds_ispro:true});s.push(r);var _=getProInfoByObj("input",{ds_id:"ds_height",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件高度",ds_placeholder:"控件高度",ds_input:"15rem",ds_name:"ds_height",ds_ispro:true});s.push(_);var a=getProInfoByObj("select",{ds_id:"ds_datasource",ds_pid:VUECFG.ctrlId,ds_labeltxt:"数据源",ds_placeholder:"数据源",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasource(),ds_select:"",ds_select_change:"changeDataSourceForCtrl",ds_select_visible_change:"changeDatasourceOption",ds_name:"ds_datasource",ds_ispro:true,group1:"数据源",group2:""});s.push(a);var l=getProInfoByObj("select",{ds_id:"ds_props_key",ds_pid:VUECFG.ctrlId,ds_labeltxt:"数据源主键",ds_placeholder:"数据源主键",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasourceField(),ds_select:"",ds_select_visible_change:"changeFieldOption",ds_name:"ds_props_key",ds_ispro:true,group1:"数据构建",group2:""});s.push(l);var o=getProInfoByObj("select",{ds_id:"ds_props_label",ds_pid:VUECFG.ctrlId,ds_labeltxt:"数据源字段别名",ds_placeholder:"数据源字段别名",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasourceField(),ds_select:"",ds_select_visible_change:"changeFieldOption",ds_name:"ds_props_label",ds_ispro:true,group1:"数据构建",group2:""});s.push(o);var i=getProInfoByObj("select",{ds_id:"ds_props_disabled",ds_pid:VUECFG.ctrlId,ds_labeltxt:"数据源禁用字段",ds_placeholder:"数据源禁用字段",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasourceField(),ds_select:"",ds_select_visible_change:"changeFieldOption",ds_name:"ds_props_disabled",ds_ispro:true,group1:"数据构建",group2:""});s.push(i);var n=getProInfoByObj("input",{ds_id:"ds_out_padding",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"内边距大小",ds_placeholder:"内边距大小",ds_input:"1rem",ds_name:"ds_out_padding",ds_ispro:true,group1:"属性",group2:"组件布局"});s.push(n);var p=getProInfoByObj("input",{ds_id:"ds_left_panel_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"左侧列表宽度",ds_placeholder:"左侧列表宽度",ds_input:"20rem",ds_name:"ds_left_panel_width",ds_input_change:"triggerRendering",ds_ispro:true,group1:"属性",group2:"组件布局"});s.push(p);var g=getProInfoByObj("input",{ds_id:"ds_right_panel_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"右侧列表宽度",ds_placeholder:"右侧列表宽度",ds_input:"20rem",ds_name:"ds_right_panel_width",ds_input_change:"triggerRendering",ds_ispro:true,group1:"属性",group2:"组件布局"});s.push(g);var c=getProInfoByObj("input",{ds_id:"ds_left_default_checked",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"左侧勾选项数组",ds_placeholder:"key1,key2",ds_input:"",ds_name:"ds_left_default_checked",ds_ispro:true,ds_valformat:"ARRAY",group1:"属性",group2:"组件属性"});s.push(c);var h=getProInfoByObj("input",{ds_id:"ds_right_default_checked",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"右侧勾选项数组",ds_placeholder:"key1,key2",ds_input:"",ds_name:"ds_right_default_checked",ds_ispro:true,ds_valformat:"ARRAY",group1:"属性",group2:"组件属性"});s.push(h);var u=getProInfoByObj("input",{ds_id:"ds_titles",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"自定义列表标题",ds_placeholder:"列表 1,列表 2",ds_input:"列表 1,列表 2",ds_name:"ds_titles",ds_ispro:true,ds_valformat:"ARRAY",group1:"属性",group2:"组件属性"});s.push(u);var f=getProInfoByObj("input",{ds_id:"ds_button_texts",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"自定义按钮文案",ds_placeholder:"左,右",ds_input:"",ds_name:"ds_button_texts",ds_ispro:true,ds_valformat:"ARRAY",group1:"属性",group2:"组件属性"});s.push(f);var b=getProInfoByObj("select",{ds_id:"ds_target_order",ds_pid:VUECFG.ctrlId,ds_labeltxt:"右侧列表排序",ds_placeholder:"右侧列表排序",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"original",label:"与数据源相同"},{value:"push",label:"按加入顺序排最后"},{value:"unshift",label:"按加入顺序排最前"}],ds_select:"original",ds_name:"ds_target_order",ds_ispro:true,group1:"属性",group2:"组件属性"});s.push(b);var m=getProInfoByObj("input",{ds_id:"ds_format_hasChecked",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"顶部未选中文案",ds_placeholder:"顶部未选中文案",ds_input:"${checked}/${total}",ds_name:"ds_format_hasChecked",ds_ispro:true,group1:"属性",group2:"组件属性"});s.push(m);var y=getProInfoByObj("input",{ds_id:"ds_format_noChecked",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"顶部未选中文案",ds_placeholder:"顶部未选中文案",ds_input:"${checked}/${total}",ds_name:"ds_format_noChecked",ds_ispro:true,group1:"属性",group2:"组件属性"});s.push(y);var v=getProInfoByObj("input",{ds_id:"ds_filter_placeholder",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"搜索框占位符",ds_placeholder:"搜索框占位符",ds_input:"",ds_name:"ds_filter_placeholder",ds_ispro:true,group1:"属性",group2:"组件属性"});s.push(v);var C=getProInfoByObj("switch",{ds_id:"ds_filterable",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否可搜索",ds_name:"ds_filterable",ds_switch:false,ds_ispro:true,group1:"属性",group2:"组件属性"});s.push(C);var j=getProInfoByObj("select",{ds_id:"ds_trigger",ds_pid:VUECFG.ctrlId,ds_labeltxt:"触发刷新控件",ds_placeholder:"请选择触发刷新控件",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[],ds_select_visible_change:"getAllPageCtrl",ds_select:"",ds_name:"ds_trigger",ds_ispro:true,ds_multiple:true,group1:"控件加载",group2:""});s.push(j);var I=getProInfoByObj("select",{ds_id:"ds_loading",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载机制",ds_placeholder:"请选择加载机制",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"first",label:"优先加载"},{value:"normal",label:"正常加载"},{value:"lazy",label:"懒加载"}],ds_select:"normal",ds_select_change:"changeCtrlLoading",ds_name:"ds_loading",ds_ispro:true,group1:"控件加载",group2:""});s.push(I);var k=getProInfoByObj("input",{ds_id:"ds_param",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"推送参数名",ds_placeholder:"控件推送参数名",ds_input:"",ds_name:"ds_param",ds_ispro:true,group1:"参数推送",group2:""});s.push(k);var F=getProInfoByObj("input",{ds_id:"ds_backParamCondition",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"撤销推送条件",ds_placeholder:"推送参数名.A=='a'||推送参数名.A=='b'",ds_input:"",ds_name:"ds_backParamCondition",ds_ispro:true,group1:"参数推送",group2:""});s.push(F);var V=getProInfoByObj("switch",{ds_id:"ds_show",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示控件",ds_name:"ds_show",ds_switch:true,ds_ispro:true,group1:"显示设置",group2:""});s.push(V);var U=getProInfoByObj("input",{ds_id:"ds_showCondition",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示条件",ds_placeholder:"${V.推送参数名.A}=='a'||${V.推送参数名.A}=='b'",ds_input:"",ds_name:"ds_showCondition",ds_ispro:true,group1:"显示设置",group2:""});s.push(U);var E=getProInfoByObj("jseditor",{ds_id:"ds_filter_method",ds_pid:VUECFG.ctrlId,ds_labeltxt:"自定义搜索方法",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:`var label=obj.ds_props_label?obj.ds_props_label:"label";\n         val.item[label].indexOf(val.query)>-1;\n        //obj:配置对象,//val:{query:搜索值,//item:每一项数据}`,ds_prepend:"fn(obj,val){",ds_jseditor_change:"",ds_name:"ds_filter_method",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});s.push(E);var G=getProInfoByObj("jseditor",{ds_id:"ds_render_content",ds_pid:VUECFG.ctrlId,ds_labeltxt:"自定义数据渲染",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象,//val:{h, option}",ds_prepend:"fn(obj,val){",ds_jseditor_change:"",ds_name:"ds_render_content",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});s.push(G);var w=getProInfoByObj("jseditor",{ds_id:"ds_transfer_change",ds_pid:VUECFG.ctrlId,ds_labeltxt:"变更事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:{val 当前值,direction 数据移动的方向（'left' / 'right'）,keyArr 发生移动的数据 key 数组}",ds_prepend:"fn(obj,val){",ds_jseditor_change:"",ds_name:"ds_transfer_change",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});s.push(w);var O=getProInfoByObj("jseditor",{ds_id:"ds_left_check_change",ds_pid:VUECFG.ctrlId,ds_labeltxt:"左侧选中变更",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:{selectKeyArr 当前被选中的元素的 key 数组,changeKeyArr 选中状态发生变化的元素的 key 数组}",ds_prepend:"fn(obj,val){",ds_jseditor_change:"",ds_name:"ds_left_check_change",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});s.push(O);var D=getProInfoByObj("jseditor",{ds_id:"ds_right_check_change",ds_pid:VUECFG.ctrlId,ds_labeltxt:"右侧选中变更",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},val:{selectKeyArr 当前被选中的元素的 key 数组,changeKeyArr 选中状态发生变化的元素的 key 数组}",ds_prepend:"fn(obj,val){",ds_jseditor_change:"",ds_name:"ds_right_check_change",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});s.push(D);var P=getProInfoByObj("jseditor",{ds_id:"ds_load_success",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载完成事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_load_success",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});s.push(P);if(VUECFG.proObj[VUECFG.ctrlId]&&!e){var x=VUECFG.proObj[VUECFG.ctrlId];for(var A=0;A<s.length;A++){for(var B=0;B<x.length;B++){if(s[A].info.ds_name==x[B].info.ds_name){var d=s[A].type.split("drag_")[1];s[A].info["ds_"+d]=x[B].info["ds_"+d];if(!$DS.util.isUndefined(x[B].info["ds_show"]))s[A].info["ds_show"]=x[B].info["ds_show"]}}}}VUECFG.proObj[VUECFG.ctrlId]=[];VUECFG.proArr=formatterCtrlProCfg(s);VUECFG.proObj[VUECFG.ctrlId]=s;$("#templetePro").click()}function getTransferData(e){var s=$DS.getCtrlById(e).info;if(!s)console.error("【ID为"+e+"】的控件不存在!");return s.ds_transfer}function setTransferData(e,s,d){var t=$DS.getCtrlById(e);var r=getSourceById(VUECFG.groupObj[e]);if(r){if(!s&&$DS.getSourceData(r,d)){s=$DS.getSourceData(r,d)}t.info.ds_transfer_data=s.rows}else{t.info.ds_transfer_data=s?s.rows:[]}}function clearTransferVal(e){e.ds_transfer=[]}