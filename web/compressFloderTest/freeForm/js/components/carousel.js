var $carousel={type:"drag_carousel",dataType:"allData",uuid:Date.parse(new Date),getConfig:getCarouselConfig,register:registerCarousel,showProperty:showPropertyCarousel,setData:setCarouselVal,getData:getCarouselVal,clearData:clearCarouselVal,setActiveItem:setActiveItem,prev:carouselPrev,next:carouselNext};function getCarouselConfig(){return{ds_id:"",ds_ctrlname:"CAROUSEL_"+$carousel.uuid++,ds_show:true,ds_width:"100%",ds_height:"30rem",ds_style:"drawing-item",ds_param:"",ds_backParamCondition:"",ds_trigger:"",ds_loading:"normal",ds_datasource:"",ds_imgurl:"",ds_imglabel:"",ds_ispro:false,ds_pid:"",ds_draggable:"true",ds_carousel_flex:true,ds_carousel_horizontally:"flex-start",ds_carousel_vertical:"flex-start",ds_carousel:[],ds_carousel_type:"",ds_carousel_initial_index:0,ds_carousel_interval:3e3,ds_carousel_indicator_position:"outside",ds_carousel_trigger:"click",ds_carousel_autoplay:true,ds_carousel_arrow:"always",ds_carousel_loop:true,ds_carousel_direction:"horizontal",ds_carousel_icon:"el-icon-left-circle-fill",ds_carousel_icon_r:"el-icon-right-circle-fill",ds_out_padding:"0rem",ds_out_margin:"0rem",ds_img_padding:"0rem",ds_img_margin:"0rem",ds_img_width:"100%",ds_img_height:"100%",ds_carousel_imgs:[{name:"",label:"",path:"https://img1.baidu.com/it/u=3593645114,3563539419&fm=26&fmt=auto&gp=0.jpg"},{name:"",label:"",path:"https://img1.baidu.com/it/u=2346282507,2171850944&fm=26&fmt=auto&gp=0.jpg"}],ds_carousel_background_color:"#99a9bf",ds_carousel_background_color_width:"100%",ds_carousel_background_color_height:"100%",ds_carousel_change:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称}//val:变更值"}}function registerCarousel(){Vue.component("drag_carousel",{props:["type","info"],created:function(){this.$nextTick(function(){addListener(this);if(!this.info.ds_ispro)temporary.loadRegister[this.info.ds_id]=true;VUECFG.$refs[this.info.ds_id]=this})},data:function(){return{multiple:this.info.ds_multiple,hide:"y-hide",refdate:Date.parse(new Date)}},watch:{},computed:{computed_carouselname:function(){if(!VUECFG.viewStatu)return this.info.ds_ctrlname;return""},computed_show:function(){var s=`${this.refdate}_change`;if(!VUECFG.viewStatu){return this.info.ds_ispro&&!this.info.ds_show?"y-hide":"y-show"}else{return this.info.ds_show?"y-show":"y-hide"}},computed_drag:function(){if(VUECFG.viewStatu)return false;return this.info.ds_draggable},computed_Ts:function(){if(!VUECFG.viewStatu){return{height:"0rem"}}},computed_style:function(){return{height:this.info.ds_height+"px"}},computed_imgstyle:function(){return{width:this.info.ds_img_width,height:this.info.ds_img_height,padding:this.info.ds_img_padding,margin:this.info.ds_img_margin}},computed_carouselstyle:function(){var s={background:this.info.ds_carousel_background_color,height:this.info.ds_carousel_background_color_height,width:this.info.ds_carousel_background_color_width,padding:this.info.ds_out_padding,margin:this.info.ds_out_margin};return s},computed_carouseloutstyle:function(){var s={};if(this.info.ds_carousel_type!="card"){s["width"]="100%";s["height"]="100%"}if(this.info.ds_carousel_flex===true){s["display"]="flex";s["webkitDisplay"]="flex";s["margin"]="auto";s["textAlign"]="center";s["justifyContent"]=this.info.ds_carousel_horizontally;s["alignItems"]=this.info.ds_carousel_vertical}return s},computed_playlist:function(){var s=[];if(this.info.ds_datasource&&this.info.ds_imgurl){var e=this.info.ds_carousel;for(var d=0;d<e.length;d++){s.push({name:d,label:e[d][this.info.ds_imglabel]?e[d][this.info.ds_imglabel]:"",path:e[d][this.info.ds_imgurl]})}}else{s=this.info.ds_carousel_imgs}return s?s:[]}},methods:{changeCurrId:changeCurrId,mouseOver:ctrlMouseOver,mouseLeave:ctrlMouseLeave,carouselChange:carouselChange},template:util.getModelHtml("drag_carousel")})}function showPropertyCarousel(s){var e=[];var d=getProInfoByObj("select",{ds_id:"type",ds_pid:VUECFG.ctrlId,ds_labeltxt:"组件类型",ds_placeholder:"组件类型",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:true,ds_options:getAllCtrl(),ds_select:$carousel.type,ds_select_change:"changeFormCtrl",ds_name:"type",ds_ispro:true});e.push(d);var t=getProInfoByObj("input",{ds_id:"ds_ctrlname",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件名",ds_placeholder:"控件名",ds_input:VUECFG.formObj[VUECFG.ctrlId].info.ds_ctrlname,ds_name:"ds_ctrlname",ds_ispro:true});e.push(t);var r=getProInfoByObj("input",{ds_id:"ds_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件宽度",ds_placeholder:"控件宽度",ds_input:"100%",ds_name:"ds_width",ds_ispro:true});e.push(r);var a=getProInfoByObj("input",{ds_id:"ds_height",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件高度",ds_placeholder:"控件高度",ds_input:"30rem",ds_name:"ds_height",ds_ispro:true});e.push(a);var l=getProInfoByObj("select",{ds_id:"ds_datasource",ds_pid:VUECFG.ctrlId,ds_labeltxt:"数据源",ds_placeholder:"数据源",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasource(),ds_select:"",ds_select_change:"changeDataSourceForCtrl",ds_select_visible_change:"changeDatasourceOption",ds_name:"ds_datasource",ds_ispro:true,group1:"数据源",group2:""});e.push(l);var _=getProInfoByObj("select",{ds_id:"ds_imgurl",ds_pid:VUECFG.ctrlId,ds_labeltxt:"图片URL字段",ds_placeholder:"图片URL字段",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasourceField(),ds_select:"",ds_select_visible_change:"changeFieldOption",ds_name:"ds_imgurl",ds_ispro:true,ds_isrequired:true,group1:"数据源",group2:""});e.push(_);var o=getProInfoByObj("select",{ds_id:"ds_imglabel",ds_pid:VUECFG.ctrlId,ds_labeltxt:"图片名称字段",ds_placeholder:"图片名称字段",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasourceField(),ds_select:"",ds_select_visible_change:"changeFieldOption",ds_name:"ds_imglabel",ds_ispro:true,ds_isrequired:true,group1:"数据源",group2:""});e.push(o);var i=getProInfoByObj("select",{ds_id:"ds_carousel_type",ds_pid:VUECFG.ctrlId,ds_labeltxt:"轮播图类型",ds_placeholder:"请选择轮播图类型",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"",label:"默认"},{value:"card",label:"卡片"}],ds_select:"",ds_name:"ds_carousel_type",ds_ispro:true,group1:"属性",group2:""});e.push(i);var u=getProInfoByObj("input",{ds_id:"ds_carousel_initial_index",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"默认图片下标",ds_placeholder:"默认图片下标",ds_input:"0",ds_name:"ds_carousel_initial_index",ds_valformat:"NUMBER",ds_ispro:true,ds_append:"",group1:"属性",group2:""});e.push(u);var n=getProInfoByObj("input",{ds_id:"ds_carousel_interval",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"切换时间",ds_placeholder:"切换时间",ds_input:3e3,ds_valformat:"NUMBER",ds_name:"ds_carousel_interval",ds_ispro:true,group1:"属性",group2:""});e.push(n);var g=getProInfoByObj("select",{ds_id:"ds_carousel_direction",ds_pid:VUECFG.ctrlId,ds_labeltxt:"图片切换方向",ds_placeholder:"图片切换方向",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"horizontal",label:"水平"},{value:"vertical",label:"垂直"}],ds_select:"horizontal",ds_name:"ds_carousel_direction",ds_ispro:true,group1:"属性",group2:"图片"});e.push(g);var c=getProInfoByObj("input",{ds_id:"ds_carousel_imgs",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"图片池",ds_placeholder:"图片池",ds_input:[{name:"",label:"",path:"https://img1.baidu.com/it/u=3593645114,3563539419&fm=26&fmt=auto&gp=0.jpg"},{name:"",label:"",path:"https://img1.baidu.com/it/u=2346282507,2171850944&fm=26&fmt=auto&gp=0.jpg"}],ds_name:"ds_carousel_imgs",ds_readonly:true,ds_input_focus:"carouselCfg",ds_valformat:"JSON",ds_ispro:true,group1:"属性",group2:"图片"});e.push(c);var p=getProInfoByObj("input",{ds_id:"ds_img_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"图片宽度",ds_placeholder:"图片宽度",ds_input:"100%",ds_name:"ds_img_width",ds_ispro:true,group1:"属性",group2:"图片"});e.push(p);var h=getProInfoByObj("input",{ds_id:"ds_img_height",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"图片高度",ds_placeholder:"图片高度",ds_input:"100%",ds_name:"ds_img_height",ds_ispro:true,group1:"属性",group2:"图片"});e.push(h);var f=getProInfoByObj("input",{ds_id:"ds_img_padding",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"内边距大小",ds_placeholder:"内边距大小",ds_input:"0rem",ds_name:"ds_img_padding",ds_ispro:true,group1:"属性",group2:"图片"});e.push(f);var m=getProInfoByObj("input",{ds_id:"ds_img_margin",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"外边距大小",ds_placeholder:"外边距大小",ds_input:"0rem",ds_name:"ds_img_margin",ds_ispro:true,group1:"属性",group2:"图片"});e.push(m);var b=getProInfoByObj("switch",{ds_id:"ds_carousel_autoplay",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"自动切换",ds_name:"ds_carousel_autoplay",ds_switch:true,ds_ispro:true,group1:"属性",group2:"图片"});e.push(b);var y=getProInfoByObj("switch",{ds_id:"ds_carousel_loop",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否循环播放",ds_name:"ds_carousel_loop",ds_switch:true,ds_ispro:true,group1:"属性",group2:"图片"});e.push(y);var v=getProInfoByObj("select",{ds_id:"ds_carousel_indicator_position",ds_pid:VUECFG.ctrlId,ds_labeltxt:"指示器位置",ds_placeholder:"请选择指示器位置",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"outside",label:"outside"},{value:"none",label:"none"}],ds_select:"outside",ds_name:"ds_carousel_indicator_position",ds_ispro:true,group1:"属性",group2:"指示器"});e.push(v);var C=getProInfoByObj("radio",{ds_id:"ds_carousel_trigger ",ds_pid:VUECFG.ctrlId,ds_labeltxt:"触发方式",ds_placeholder:"触发方式",ds_draggable:"false",ds_style:"ds-mt-1",ds_name:"ds_carousel_trigger",ds_options:[{value:"click",text:"点击"},{value:"hover",text:"鼠标经过"}],ds_radio:"click",ds_ispro:true,ds_radiobtn:true,ds_radio_change:"carouselTypeChange",group1:"属性",group2:"指示器"});e.push(C);var I=getProInfoByObj("select",{ds_id:"ds_carousel_arrow",ds_pid:VUECFG.ctrlId,ds_labeltxt:"显示切换箭头方式",ds_placeholder:"显示切换箭头方式",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"always",label:"一直显示"},{value:"hover",label:"鼠标悬停显示"},{value:"never",label:"不显示"}],ds_select:"always",ds_name:"ds_carousel_arrow",ds_valformat:"STRING",ds_ispro:true,group1:"属性",group2:"指示器"});e.push(I);var x=getProInfoByObj("color",{ds_id:"ds_carousel_background_color",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"背景颜色",ds_name:"ds_carousel_background_color",ds_ispro:true,ds_show_alpha:true,ds_color:"#99a9bf",group1:"属性",group2:"背景"});e.push(x);var w=getProInfoByObj("input",{ds_id:"ds_carousel_background_color_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"背景宽度",ds_placeholder:"背景宽度",ds_input:"100%",ds_name:"ds_carousel_background_color_width",ds_ispro:true,group1:"属性",group2:"背景"});e.push(w);var V=getProInfoByObj("input",{ds_id:"ds_carousel_background_color_height",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"背景高度",ds_placeholder:"背景高度",ds_input:"100%",ds_name:"ds_carousel_background_color_height",ds_ispro:true,group1:"属性",group2:"背景"});e.push(V);var F=getProInfoByObj("input",{ds_id:"ds_out_padding",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"内边距大小",ds_placeholder:"内边距大小",ds_input:"0rem",ds_name:"ds_out_padding",ds_ispro:true,group1:"属性",group2:"背景"});e.push(F);var U=getProInfoByObj("input",{ds_id:"ds_out_margin",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"外边距大小",ds_placeholder:"外边距大小",ds_input:"0rem",ds_name:"ds_out_margin",ds_ispro:true,group1:"属性",group2:"背景"});e.push(U);var E=getProInfoByObj("switch",{ds_id:"ds_carousel_flex",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"开启弹性布局",ds_name:"ds_carousel_flex",ds_switch:true,ds_ispro:true,ds_switch_change:"flexChange",group1:"属性",group2:"弹性布局"});e.push(E);var G=getProInfoByObj("select",{ds_id:"ds_carousel_horizontally",ds_pid:VUECFG.ctrlId,ds_labeltxt:"文本水平排列",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"flex-start",label:"左对齐"},{value:"flex-end",label:"右对齐"},{value:"center",label:"居中"}],ds_select:"flex-start",ds_name:"ds_carousel_horizontally",ds_ispro:true,ds_show:true,group1:"属性",group2:"弹性布局"});e.push(G);var j=getProInfoByObj("select",{ds_id:"ds_carousel_vertical",ds_pid:VUECFG.ctrlId,ds_labeltxt:"文本垂直排列",ds_placeholder:"",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"flex-start",label:"上对齐"},{value:"flex-end",label:"下对齐"},{value:"center",label:"居中"}],ds_select:"flex-start",ds_name:"ds_carousel_vertical",ds_ispro:true,ds_show:true,group1:"属性",group2:"弹性布局"});e.push(j);var O=getProInfoByObj("input",{ds_id:"ds_param",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"推送参数名",ds_placeholder:"控件推送参数名",ds_input:"",ds_name:"ds_param",ds_ispro:true,group1:"参数推送",group2:""});e.push(O);var P=getProInfoByObj("input",{ds_id:"ds_backParamCondition",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"撤销推送条件",ds_placeholder:"推送参数名.A=='a'||推送参数名.A=='b'",ds_input:"",ds_name:"ds_backParamCondition",ds_ispro:true,group1:"参数推送",group2:""});e.push(P);var B=getProInfoByObj("select",{ds_id:"ds_trigger",ds_pid:VUECFG.ctrlId,ds_labeltxt:"触发刷新控件",ds_placeholder:"请选择触发刷新控件",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[],ds_select_visible_change:"getAllPageCtrl",ds_select:"",ds_name:"ds_trigger",ds_ispro:true,ds_multiple:true,group1:"控件加载",group2:""});e.push(B);var D=getProInfoByObj("select",{ds_id:"ds_loading",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载机制",ds_placeholder:"请选择加载机制",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"first",label:"优先加载"},{value:"normal",label:"正常加载"},{value:"lazy",label:"懒加载"}],ds_select:"normal",ds_select_change:"changeCtrlLoading",ds_name:"ds_loading",ds_ispro:true,group1:"控件加载",group2:""});e.push(D);var S=getProInfoByObj("switch",{ds_id:"ds_show",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示控件",ds_name:"ds_show",ds_switch:true,ds_ispro:true,group1:"显示设置",group2:""});e.push(S);var k=getProInfoByObj("jseditor",{ds_id:"ds_carousel_change",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载完成事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_carousel_change",ds_ispro:true,group1:"事件",group2:""});e.push(k);if(VUECFG.proObj[VUECFG.ctrlId]&&!s){var A=VUECFG.proObj[VUECFG.ctrlId];for(var z=0;z<e.length;z++){for(var L=0;L<A.length;L++){if(e[z].info.ds_name==A[L].info.ds_name){var d=e[z].type.split("drag_")[1];e[z].info["ds_"+d]=A[L].info["ds_"+d];if(!$DS.util.isUndefined(A[L].info["ds_show"]))e[z].info["ds_show"]=A[L].info["ds_show"]}}}}VUECFG.proObj[VUECFG.ctrlId]=[];VUECFG.proArr=formatterCtrlProCfg(e);VUECFG.proObj[VUECFG.ctrlId]=e;$("#templetePro").click()}function ctrlMouseLeave(s){if(this.info.ds_ispro)return;this.hide="y-hide"}function ctrlMouseOver(s){if(this.info.ds_ispro)return;this.hide=VUECFG.viewStatu?"y-hide":"y-show"}function loadSuccess(s,e){var d=this.info;$DS.eval(d.ds_load_success,d)}function carouselChange(s,e){var d=this.info;var t={newVal:s,oldVal:e};$DS.eval(d.ds_carousel_change,d,t);$DS.dealPms(d,t);if(d.ds_trigger&&d.ds_trigger.length>0){triggerComps(d.ds_trigger,$DS.getCtrlType(d.ds_id))}}function flexChange(s,e){s.ds_carousel_flex=e;$DS.setRightProShow(s.ds_pid,{ds_carousel_horizontally:e?true:false,ds_carousel_vertical:e?true:false})}function carouselCfg(s,e){var d=s.ds_input;if(d&&d.length>0){var t=new Base64;for(let s=0;s<d.length;s++){if(d[s].content&&isBase64Code(d[s].content)){d[s].content=t.decode(d[s].content)}}}$DS.openCfgTable([{field:"name",title:"下标",width:.33,edit:"text"},{field:"label   ",title:"标题",width:.33,edit:"text"},{field:"path",title:"背景图片",width:.33,codeType:"image"}],d,function(e,d){e=JSON.parse(e);$DS.getCtrlById(s.ds_pid).info.ds_carousel_imgs=e;s.ds_input=e},"95%","80%","轮播图图片池",{id:s.ds_pid})}function setCarouselVal(s,e,d){var t=$DS.getCtrlById(s);var r=getSourceById(VUECFG.groupObj[s]);if(r){if(!e&&$DS.getSourceData(r,d)){e=$DS.getSourceData(r,d)}t.info.ds_carousel=e.rows}else{t.info.ds_carousel=e?e.rows:[]}}function getCarouselVal(s){var e=$DS.getCtrlById(s);if(!e)console.error("【ID为"+s+"】的控件不存在!");return e.info.ds_carousel}function clearCarouselVal(s){s.info.ds_carousel=[]}function setActiveItem(s,e){var d=$DS.getCtrl(s).info.ds_id;VUECFG.$refs[d].setActiveItem(e)}function carouselPrev(s){var e=$DS.getCtrl(s).info.ds_id;VUECFG.$refs[e].prev()}function carouselNext(s){var e=$DS.getCtrl(s).info.ds_id;VUECFG.$refs[e].next()}