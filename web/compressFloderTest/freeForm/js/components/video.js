var $video={type:"drag_video",dataType:"singeleData",uuid:Date.parse(new Date),getConfig:getVideoConfig,register:registerVideo,showProperty:showPropertyVideo,setData:setVideoVal,getData:getVideoVal};function getVideoConfig(){return{ds_id:"",ds_ctrlname:"VIDEO_"+$video.uuid++,ds_show:true,ds_width:"100%",ds_height:"30rem",ds_labelwidth:"10",ds_innerwidth:"calc(100% - 2rem)",ds_style:"drawing-item",ds_showlable:true,ds_isrequired:false,ds_param:"",ds_backParamCondition:"",ds_trigger:"",ds_loading:"normal",ds_labelcolor:"#606266",ds_labelfontweight:"bold",ds_showTitTip:false,ds_out_padding:"0rem",ds_out_margin:"0rem",ds_datasource:"",ds_name:"",ds_datatypeforval:"empty",ds_datafilter:"",ds_dataindex:0,ds_video:"",ds_ispro:false,ds_pid:"",ds_draggable:"true",ds_defaultval:"",ds_video_source:"http://vjs.zencdn.net/v/oceans.mp4",ds_video_type:"video/mp4",ds_video_poster:"../editor/video/img/m.jpg",ds_video_autoplay:true,ds_load_success:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_video_play:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_video_ended:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_video_load_start:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_video_pause:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_video_firstplay:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新"}}function registerVideo(){Vue.component("drag_video",{props:["type","info"],created:function(){this.$nextTick(function(){addListener(this);videojs.addLanguage("zh-CN",{Play:"播放",Pause:"暂停","Current Time":"当前时间",Duration:"时长","Remaining Time":"剩余时间","Stream Type":"媒体流类型",LIVE:"直播",Loaded:"加载完毕",Progress:"进度",Fullscreen:"全屏","Non-Fullscreen":"退出全屏",Mute:"静音",Unmute:"取消静音","Playback Rate":"播放速度",Subtitles:"字幕","subtitles off":"关闭字幕",Captions:"内嵌字幕","captions off":"关闭内嵌字幕",Chapters:"节目段落","Close Modal Dialog":"关闭弹窗",Descriptions:"描述","descriptions off":"关闭描述","Audio Track":"音轨","You aborted the media playback":"视频播放被终止","A network error caused the media download to fail part-way.":"网络错误导致视频下载中途失败。","The media could not be loaded, either because the server or network failed or because the format is not supported.":"视频因格式不支持或者服务器或网络的问题无法加载。","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"由于视频文件损坏或是该视频使用了你的浏览器不支持的功能，播放终止。","No compatible source was found for this media.":"无法找到此视频兼容的源。","The media is encrypted and we do not have the keys to decrypt it.":"视频已加密，无法解密。","Play Video":"播放视频",Close:"关闭","Modal Window":"弹窗","This is a modal window":"这是一个弹窗","This modal can be closed by pressing the Escape key or activating the close button.":"可以按ESC按键或启用关闭按钮来关闭此弹窗。",", opens captions settings dialog":", 开启标题设置弹窗",", opens subtitles settings dialog":", 开启字幕设置弹窗",", opens descriptions settings dialog":", 开启描述设置弹窗",", selected":", 选择","captions settings":"字幕设定","Audio Player":"音频播放器","Video Player":"视频播放器",Replay:"重播","Progress Bar":"进度小节","Volume Level":"音量","subtitles settings":"字幕设定","descriptions settings":"描述设定",Text:"文字",White:"白",Black:"黑",Red:"红",Green:"绿",Blue:"蓝",Yellow:"黄",Magenta:"紫红",Cyan:"青",Background:"背景",Window:"视窗",Transparent:"透明","Semi-Transparent":"半透明",Opaque:"不透明","Font Size":"字体尺寸","Text Edge Style":"字体边缘样式",None:"无",Raised:"浮雕",Depressed:"压低",Uniform:"均匀",Dropshadow:"下阴影","Font Family":"字体库","Proportional Sans-Serif":"比例无细体","Monospace Sans-Serif":"单间隔无细体","Proportional Serif":"比例细体","Monospace Serif":"单间隔细体",Casual:"舒适",Script:"手写体","Small Caps":"小型大写字体",Reset:"重启","restore all settings to the default values":"恢复全部设定至预设值",Done:"完成","Caption Settings Dialog":"字幕设定视窗","Beginning of dialog window. Escape will cancel and close the window.":"开始对话视窗。离开会取消及关闭视窗","End of dialog window.":"结束对话视窗"});if(this.info.ds_video_autoplay){debugger;var d=videojs(this.info.ds_id+"_video");d.play()}if(!this.info.ds_ispro)temporary.loadRegister[this.info.ds_id]=true;VUECFG.$refs[this.info.ds_id]=this})},data:function(){return{multiple:this.info.ds_multiple,hide:"y-hide",refdate:Date.parse(new Date)}},watch:{},computed:{computed_resize:function(){return{height:this.info.ds_height,width:this.info.ds_width}},computed_style:function(){var d={height:"100%",width:"100%",padding:this.info.ds_out_padding,margin:this.info.ds_out_margin};return d},computed_videoname:function(){if(!VUECFG.viewStatu)return this.info.ds_ctrlname;return""},computed_show:function(){var d=`${this.refdate}_change`;if(!VUECFG.viewStatu){return this.info.ds_ispro&&!this.info.ds_show?"y-hide":"y-show"}else{return this.info.ds_show?"y-show":"y-hide"}},computed_drag:function(){if(VUECFG.viewStatu)return false;return this.info.ds_draggable},computed_Ts:function(){if(!this.info.ds_showTitTip&&VUECFG.viewStatu){return{height:"0rem"}}},computed_padding:function(){if(this.info.ds_ispro===true){return"1rem 0px"}},computed_marginleft:function(){return this.info.ds_showlable?this.info.ds_labelwidth+"rem":"0rem"},computed_muted:function(){return this.info.ds_video_autoplay},computed_video_url:function(){debugger;var d="";if(this.info.ds_datasource&&this.info.ds_video){d=this.info.ds_video}else{d=this.info.ds_video_source}$(`#${this.info.ds_id}`).find("video").attr("src",d);return d}},methods:{changeCurrId:changeCurrId,mouseOver:ctrlMouseOver,mouseLeave:ctrlMouseLeave,loadstart:videoLoadStart,play:videoPlay,ended:videoEnded,pause:videoPause,firstplay:videoFirstPlay},template:util.getModelHtml("drag_video")})}function showPropertyVideo(d){var e=[];var s=getProInfoByObj("select",{ds_id:"type",ds_pid:VUECFG.ctrlId,ds_labeltxt:"组件类型",ds_placeholder:"组件类型",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:true,ds_options:getAllCtrl(),ds_select:$video.type,ds_select_change:"changeFormCtrl",ds_name:"type",ds_ispro:true});e.push(s);var t=getProInfoByObj("input",{ds_id:"ds_ctrlname",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件名",ds_placeholder:"控件名",ds_input:VUECFG.formObj[VUECFG.ctrlId].info.ds_ctrlname,ds_name:"ds_ctrlname",ds_ispro:true});e.push(t);var o=getProInfoByObj("input",{ds_id:"ds_width",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件宽度",ds_placeholder:"控件宽度",ds_input:"100%",ds_name:"ds_width",ds_ispro:true});e.push(o);var i=getProInfoByObj("input",{ds_id:"ds_height",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"控件高度",ds_placeholder:"控件高度",ds_input:"30rem",ds_name:"ds_height",ds_ispro:true});e.push(i);var r=getProInfoByObj("select",{ds_id:"ds_datasource",ds_pid:VUECFG.ctrlId,ds_labeltxt:"数据源",ds_placeholder:"数据源",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasource(),ds_select:"",ds_select_change:"changeDataSourceForCtrl",ds_select_visible_change:"changeDatasourceOption",ds_name:"ds_datasource",ds_ispro:true,group1:"数据源",group2:""});e.push(r);var a=getProInfoByObj("select",{ds_id:"ds_name",ds_pid:VUECFG.ctrlId,ds_labeltxt:"选择地址字段",ds_placeholder:"点击选择字段",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:getAllDatasourceField(),ds_select:"",ds_select_change:"changeFieldNameForCtrl",ds_select_visible_change:"changeFieldOption",ds_name:"ds_name",ds_ispro:true,ds_isrequired:true,group1:"数据源",group2:""});e.push(a);var _=getProInfoByObj("input",{ds_id:"ds_out_padding",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"内边距大小",ds_placeholder:"内边距大小",ds_input:"0rem",ds_name:"ds_out_padding",ds_ispro:true,group1:"组件样式",group2:""});e.push(_);var l=getProInfoByObj("input",{ds_id:"ds_out_margin",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"外边距大小",ds_placeholder:"外边距大小",ds_input:"0rem",ds_name:"ds_out_margin",ds_ispro:true,group1:"组件样式",group2:""});e.push(l);var n=getProInfoByObj("switch",{ds_id:"ds_showlable",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示标签",ds_name:"ds_showlable",ds_switch:true,ds_ispro:true,group1:"显示设置",group2:""});e.push(n);var p=getProInfoByObj("input",{ds_id:"ds_defaultval",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"缺省值",ds_placeholder:"${V.参数,'缺省值'}",ds_input:"",ds_name:"ds_defaultval",ds_ispro:true,group1:"缺省值",group2:""});e.push(p);var u=getProInfoByObj("input",{ds_id:"ds_param",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"推送参数名",ds_placeholder:"控件推送参数名",ds_input:"",ds_name:"ds_param",ds_ispro:true,group1:"参数推送",group2:""});e.push(u);var g=getProInfoByObj("input",{ds_id:"ds_backParamCondition",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"撤销推送条件",ds_placeholder:"推送参数名.A=='a'||推送参数名.A=='b'",ds_input:"",ds_name:"ds_backParamCondition",ds_ispro:true,group1:"参数推送",group2:""});e.push(g);var c=getProInfoByObj("select",{ds_id:"ds_trigger",ds_pid:VUECFG.ctrlId,ds_labeltxt:"触发刷新控件",ds_placeholder:"请选择触发刷新控件",ds_style:"ds-mt-1",ds_draggable:"false",ds_options:[],ds_select_visible_change:"getAllPageCtrl",ds_select:"",ds_name:"ds_trigger",ds_ispro:true,ds_multiple:true});e.push(c);var f=getProInfoByObj("select",{ds_id:"ds_loading",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载机制",ds_placeholder:"请选择加载机制",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"first",label:"优先加载"},{value:"normal",label:"正常加载"},{value:"lazy",label:"懒加载"}],ds_select:"normal",ds_select_change:"changeCtrlLoading",ds_name:"ds_loading",ds_ispro:true});e.push(f);var h=getProInfoByObj("switch",{ds_id:"ds_show",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"显示控件",ds_name:"ds_show",ds_switch:true,ds_ispro:true,group1:"显示设置",group2:""});e.push(h);var m=getProInfoByObj("input",{ds_id:"ds_video_source",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"视频源地址",ds_placeholder:"http://vjs.zencdn.net/v/oceans.mp4",ds_input:"",ds_name:"ds_video_source",ds_ispro:true,group1:"视频设置",group2:""});e.push(m);var v=getProInfoByObj("select",{ds_id:"ds_video_type",ds_pid:VUECFG.ctrlId,ds_labeltxt:"视频格式",ds_placeholder:"请选择视频格式",ds_style:"ds-mt-1",ds_draggable:"false",ds_group:false,ds_options:[{value:"video/mp4",label:"mp4"},{value:"video/webm",label:"webm"},{value:"video/ogg",label:"ogg"}],ds_select:"mp4",ds_name:"ds_video_type",ds_ispro:true,group1:"视频设置",group2:""});e.push(v);var b=getProInfoByObj("input",{ds_id:"ds_video_poster",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"视频封面地址",ds_placeholder:"img/m.jpg",ds_input:"",ds_name:"ds_video_poster",ds_ispro:true,group1:"视频设置",group2:""});e.push(b);var y=getProInfoByObj("switch",{ds_id:"ds_video_autoplay",ds_pid:VUECFG.ctrlId,ds_draggable:"false",ds_style:"ds-mt-1",ds_labeltxt:"是否开启自动播放",ds_name:"ds_video_autoplay",ds_switch:true,ds_ispro:true,ds_switch_change:"autoplayChange",group1:"视频设置",group2:"是否开启自动播放"});e.push(y);var j=getProInfoByObj("jseditor",{ds_id:"ds_load_success",ds_pid:VUECFG.ctrlId,ds_labeltxt:"加载完成事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_load_success",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(j);var C=getProInfoByObj("jseditor",{ds_id:"ds_video_load_start",ds_pid:VUECFG.ctrlId,ds_labeltxt:"视频开始加载事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_video_load_start",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(C);var w=getProInfoByObj("jseditor",{ds_id:"ds_video_play",ds_pid:VUECFG.ctrlId,ds_labeltxt:"视频开始播放事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_video_play",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(w);var V=getProInfoByObj("jseditor",{ds_id:"ds_video_firstplay",ds_pid:VUECFG.ctrlId,ds_labeltxt:"视频首次播放事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_video_firstplay",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(V);var I=getProInfoByObj("jseditor",{ds_id:"ds_video_pause",ds_pid:VUECFG.ctrlId,ds_labeltxt:"视频暂停事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_video_pause",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(I);var F=getProInfoByObj("jseditor",{ds_id:"ds_video_ended",ds_pid:VUECFG.ctrlId,ds_labeltxt:"视频播放结束事件",ds_placeholder:"脚本",ds_style:"ds-mt-1",ds_draggable:"false",ds_jseditor:"//obj:配置对象{ds_id:组件id,ds_ctrlname:组件名称},//trigger:是否触发控件刷新",ds_prepend:"fn(obj,trigger){",ds_jseditor_change:"",ds_name:"ds_video_ended",ds_ispro:true,ds_savedb:false,group1:"事件",group2:""});e.push(F);if(VUECFG.proObj[VUECFG.ctrlId]&&!d){var E=VUECFG.proObj[VUECFG.ctrlId];for(var P=0;P<e.length;P++){for(var U=0;U<E.length;U++){if(e[P].info.ds_name==E[U].info.ds_name){var s=e[P].type.split("drag_")[1];e[P].info["ds_"+s]=E[U].info["ds_"+s];if(!$DS.util.isUndefined(E[U].info["ds_show"]))e[P].info["ds_show"]=E[U].info["ds_show"]}}}}VUECFG.proObj[VUECFG.ctrlId]=[];VUECFG.proArr=formatterCtrlProCfg(e);VUECFG.proObj[VUECFG.ctrlId]=e;$("#templetePro").click()}function ctrlMouseLeave(d){if(this.info.ds_ispro)return;this.hide="y-hide"}function ctrlMouseOver(d){if(this.info.ds_ispro)return;this.hide=VUECFG.viewStatu?"y-hide":"y-show"}function loadSuccess(d,e){var s=this.info;$DS.eval(s.ds_load_success,s)}function videoPlay(d){var e=this.info;$DS.eval(e.ds_video_play,e)}function videoEnded(d){var e=this.info;$DS.eval(e.ds_video_ended,e)}function videoPause(d){var e=this.info;$DS.eval(e.ds_video_pause,e)}function videoLoadStart(d){var e=videojs(this.info.ds_id+"_video");var s=this.info;$DS.eval(s.ds_video_load_start,s)}function videoFirstPlay(d){var e=this.info;$DS.eval(e.ds_video_firstplay,e)}function setVideoVal(d,e,s){var t=$DS.getCtrlById(d);var o=getSourceById(VUECFG.groupObj[d]);if(o){if(!e&&t.info.ds_name&&$DS.getSourceData(o,s)){e=$DS.getSourceData(o,s)[t.info.ds_name]}t.info.ds_video=e}else{t.info.ds_video=e?e:""}}function getVideoVal(d){var e=$DS.getCtrlById(d);if(!e)console.error("【ID为"+d+"】的控件不存在!");return e.info.ds_video?e.info.ds_video:e.info.ds_video_source}