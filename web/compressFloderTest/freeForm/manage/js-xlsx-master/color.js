function hex2RGB(r){var t=r.substr(r[0]==="#"?1:0,6);var e=t.substr(0,2);var o=t.substr(2,2);var g=t.substr(4,2);return[parseInt(e,16),parseInt(o,16),parseInt(g,16)]}function rgb2Hex(r){for(var t=0,e=1;t!=3;++t)e=e*256+(r[t]>255?255:r[t]<0?0:r[t]);return e.toString(16).toUpperCase().substr(1)}function rgb2HSL(r){var t=r[0]/255,e=r[1]/255,o=r[2]/255;var g=Math.max(t,e,o),a=Math.min(t,e,o),n=g-a;if(n===0)return[0,0,t];var b=0,l=0,i=g+a;l=n/(i>1?2-i:i);switch(g){case t:b=((e-o)/n+6)%6;break;case e:b=(o-t)/n+2;break;case o:b=(t-e)/n+4;break}return[b/6,l,i/2]}function hsl2RGB(r){var t=r[0],e=r[1],o=r[2];var g=e*2*(o<.5?o:1-o),a=o-g/2;var n=[a,a,a],b=6*t;var l;if(e!==0)switch(b|0){case 0:case 6:l=g*b;n[0]+=g;n[1]+=l;break;case 1:l=g*(2-b);n[0]+=l;n[1]+=g;break;case 2:l=g*(b-2);n[1]+=g;n[2]+=l;break;case 3:l=g*(4-b);n[1]+=l;n[2]+=g;break;case 4:l=g*(b-4);n[2]+=g;n[0]+=l;break;case 5:l=g*(6-b);n[2]+=l;n[0]+=g;break}for(var i=0;i!=3;++i)n[i]=Math.round(n[i]*255);return n}function rgb_tint(r,t){if(t===0)return r;var e=rgb2HSL(hex2RGB(r));if(t<0)e[2]=e[2]*(1+t);else e[2]=1-(1-e[2])*(1-t);return rgb2Hex(hsl2RGB(e))}var exp=[{patternType:"darkHorizontal",fgColor:{theme:9,tint:-.249977111117893,rgb:"F79646"},bgColor:{theme:5,tint:.3999755851924192,rgb:"C0504D"}},{patternType:"darkUp",fgColor:{theme:3,tint:-.249977111117893,rgb:"EEECE1"},bgColor:{theme:7,tint:.3999755851924192,rgb:"8064A2"}},{patternType:"darkGray",fgColor:{theme:3,rgb:"EEECE1"},bgColor:{theme:1,rgb:"FFFFFF"}},{patternType:"lightGray",fgColor:{theme:6,tint:.3999755851924192,rgb:"9BBB59"},bgColor:{theme:2,tint:-.499984740745262,rgb:"1F497D"}},{patternType:"lightDown",fgColor:{theme:4,rgb:"4F81BD"},bgColor:{theme:7,rgb:"8064A2"}},{patternType:"lightGrid",fgColor:{theme:6,tint:-.249977111117893,rgb:"9BBB59"},bgColor:{theme:9,tint:-.249977111117893,rgb:"F79646"}},{patternType:"lightGrid",fgColor:{theme:4,rgb:"4F81BD"},bgColor:{theme:2,tint:-.749992370372631,rgb:"1F497D"}},{patternType:"lightVertical",fgColor:{theme:3,tint:.3999755851924192,rgb:"EEECE1"},bgColor:{theme:7,tint:.3999755851924192,rgb:"8064A2"}}];var map=[];exp.forEach(function(r){r.fgColor.new=rgb_tint(r.fgColor.rgb,r.fgColor.tint||0);console.log(r.fgColor.rgb,r.fgColor.new);r.bgColor.new=rgb_tint(r.bgColor.rgb,r.bgColor.tint||0);console.log(r.bgColor.rgb,r.bgColor.new)});