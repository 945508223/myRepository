function _JS2ANSI(r){if(typeof cptable!=="undefined")return cptable.utils.encode(1252,r);return r.split("").map(function(r){return r.charCodeAt(0)})}function parse_Version(r,e){var a={};a.Major=r.read_shift(2);a.Minor=r.read_shift(2);return a}function parse_EncryptionHeader(r,e){var a={};a.Flags=r.read_shift(4);var n=r.read_shift(4);if(n!==0)throw"Unrecognized SizeExtra: "+n;a.AlgID=r.read_shift(4);switch(a.AlgID){case 0:case 26625:case 26126:case 26127:case 26128:break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}parsenoop(r,e-12);return a}function parse_EncryptionVerifier(r,e){return parsenoop(r,e)}function parse_RC4CryptoHeader(r,e){var a={};var n=a.EncryptionVersionInfo=parse_Version(r,4);e-=4;if(n.Minor!=2)throw"unrecognized minor version code: "+n.Minor;if(n.Major>4||n.Major<2)throw"unrecognized major version code: "+n.Major;a.Flags=r.read_shift(4);e-=4;var t=r.read_shift(4);e-=4;a.EncryptionHeader=parse_EncryptionHeader(r,t);e-=t;a.EncryptionVerifier=parse_EncryptionVerifier(r,e);return a}function parse_RC4Header(r,e){var a={};var n=a.EncryptionVersionInfo=parse_Version(r,4);e-=4;if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;a.Salt=r.read_shift(16);a.EncryptedVerifier=r.read_shift(16);a.EncryptedVerifierHash=r.read_shift(16);return a}function crypto_CreatePasswordVerifier_Method1(r){var e=0,a;var n=_JS2ANSI(r);var t=n.length+1,i,o;var s,f,c;a=new_raw_buf(t);a[0]=n.length;for(i=1;i!=t;++i)a[i]=n[i-1];for(i=t-1;i>=0;--i){o=a[i];s=(e&16384)===0?0:1;f=e<<1&32767;c=s|f;e=c^o}return e^52811}var crypto_CreateXorArray_Method1=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0];var e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163];var a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628];var n=function(r){return(r/2|r*128)&255};var t=function(r,e){return n(r^e)};var i=function(r){var n=e[r.length-1];var t=104;for(var i=r.length-1;i>=0;--i){var o=r[i];for(var s=0;s!=7;++s){if(o&64)n^=a[t];o*=2;--t}}return n};return function(e){var a=_JS2ANSI(e);var n=i(a);var o=a.length;var s=new_raw_buf(16);for(var f=0;f!=16;++f)s[f]=0;var c,p,u;if((o&1)===1){c=n>>8;s[o]=t(r[0],c);--o;c=n&255;p=a[a.length-1];s[o]=t(p,c)}while(o>0){--o;c=n>>8;s[o]=t(a[o],c);--o;c=n&255;s[o]=t(a[o],c)}o=15;u=15-a.length;while(u>0){c=n>>8;s[o]=t(r[u],c);--o;--u;c=n&255;s[o]=t(a[o],c);--o;--u}return s}}();var crypto_DecryptData_Method1=function(r,e,a,n,t){if(!t)t=e;if(!n)n=crypto_CreateXorArray_Method1(r);var i,o;for(i=0;i!=e.length;++i){o=e[i];o^=n[a];o=(o>>5|o<<3)&255;t[i]=o;++a}return[t,a,n]};var crypto_MakeXorDecryptor=function(r){var e=0,a=crypto_CreateXorArray_Method1(r);return function(r){var n=crypto_DecryptData_Method1(null,r,e,a);e=n[1];return n[0]}};function parse_XORObfuscation(r,e,a,n){var t={key:parseuint16(r),verificationBytes:parseuint16(r)};if(a.password)t.verifier=crypto_CreatePasswordVerifier_Method1(a.password);n.valid=t.verificationBytes===t.verifier;if(n.valid)n.insitu_decrypt=crypto_MakeXorDecryptor(a.password);return t}function parse_FilePassHeader(r,e,a){var n=a||{};n.Info=r.read_shift(2);r.l-=2;if(n.Info===1)n.Data=parse_RC4Header(r,e);else n.Data=parse_RC4CryptoHeader(r,e);return n}function parse_FilePass(r,e,a){var n={Type:r.read_shift(2)};if(n.Type)parse_FilePassHeader(r,e-2,n);else parse_XORObfuscation(r,e-2,a,n);return n}