function parseread(r){return function(e,a){e.l+=r;return}}function parseread1(r,e){r.l+=1;return}function parse_ColRelU(r,e){var a=r.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function parse_RgceArea(r,e){var a=r.read_shift(2),t=r.read_shift(2);var s=parse_ColRelU(r,2);var p=parse_ColRelU(r,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:t,c:p[0],cRel:p[1],rRel:p[2]}}}function parse_RgceAreaRel(r,e){var a=r.read_shift(2),t=r.read_shift(2);var s=parse_ColRelU(r,2);var p=parse_ColRelU(r,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:t,c:p[0],cRel:p[1],rRel:p[2]}}}function parse_RgceLoc(r,e){var a=r.read_shift(2);var t=parse_ColRelU(r,2);return{r:a,c:t[0],cRel:t[1],rRel:t[2]}}function parse_RgceLocRel(r,e){var a=r.read_shift(2);var t=r.read_shift(2);var s=(t&32768)>>15,p=(t&16384)>>14;t&=16383;if(s!==0)while(t>=256)t-=256;return{r:a,c:t,cRel:s,rRel:p}}function parse_PtgArea(r,e){var a=(r[r.l++]&96)>>5;var t=parse_RgceArea(r,8);return[a,t]}function parse_PtgArea3d(r,e){var a=(r[r.l++]&96)>>5;var t=r.read_shift(2);var s=parse_RgceArea(r,8);return[a,t,s]}function parse_PtgAreaErr(r,e){var a=(r[r.l++]&96)>>5;r.l+=8;return[a]}function parse_PtgAreaErr3d(r,e){var a=(r[r.l++]&96)>>5;var t=r.read_shift(2);r.l+=8;return[a,t]}function parse_PtgAreaN(r,e){var a=(r[r.l++]&96)>>5;var t=parse_RgceAreaRel(r,8);return[a,t]}function parse_PtgArray(r,e){var a=(r[r.l++]&96)>>5;r.l+=7;return[a]}function parse_PtgAttrBaxcel(r,e){var a=r[r.l+1]&1;var t=1;r.l+=4;return[a,t]}function parse_PtgAttrChoose(r,e){r.l+=2;var a=r.read_shift(2);var t=[];for(var s=0;s<=a;++s)t.push(r.read_shift(2));return t}function parse_PtgAttrGoto(r,e){var a=r[r.l+1]&255?1:0;r.l+=2;return[a,r.read_shift(2)]}function parse_PtgAttrIf(r,e){var a=r[r.l+1]&255?1:0;r.l+=2;return[a,r.read_shift(2)]}function parse_PtgAttrSemi(r,e){var a=r[r.l+1]&255?1:0;r.l+=4;return[a]}function parse_PtgAttrSpaceType(r,e){var a=r.read_shift(1),t=r.read_shift(1);return[a,t]}function parse_PtgAttrSpace(r,e){r.read_shift(2);return parse_PtgAttrSpaceType(r,2)}function parse_PtgAttrSpaceSemi(r,e){r.read_shift(2);return parse_PtgAttrSpaceType(r,2)}function parse_PtgRef(r,e){var a=r[r.l]&31;var t=(r[r.l]&96)>>5;r.l+=1;var s=parse_RgceLoc(r,4);return[t,s]}function parse_PtgRefN(r,e){var a=r[r.l]&31;var t=(r[r.l]&96)>>5;r.l+=1;var s=parse_RgceLocRel(r,4);return[t,s]}function parse_PtgRef3d(r,e){var a=r[r.l]&31;var t=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(2);var p=parse_RgceLoc(r,4);return[t,s,p]}function parse_PtgFunc(r,e){var a=r[r.l]&31;var t=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(2);return[FtabArgc[s],Ftab[s]]}function parse_PtgFuncVar(r,e){r.l++;var a=r.read_shift(1),t=parsetab(r);return[a,(t[0]===0?Ftab:Cetab)[t[1]]]}function parsetab(r,e){return[r[r.l+1]>>7,r.read_shift(2)&32767]}var parse_PtgAttrSum=parseread(4);var parse_PtgConcat=parseread1;function parse_PtgExp(r,e){r.l++;var a=r.read_shift(2);var t=r.read_shift(2);return[a,t]}function parse_PtgErr(r,e){r.l++;return BErr[r.read_shift(1)]}function parse_PtgInt(r,e){r.l++;return r.read_shift(2)}function parse_PtgBool(r,e){r.l++;return r.read_shift(1)!==0}function parse_PtgNum(r,e){r.l++;return parse_Xnum(r,8)}function parse_PtgStr(r,e){r.l++;return parse_ShortXLUnicodeString(r)}function parse_SerAr(r){var e=[];switch(e[0]=r.read_shift(1)){case 4:e[1]=parsebool(r,1)?"TRUE":"FALSE";r.l+=7;break;case 16:e[1]=BErr[r[r.l]];r.l+=8;break;case 0:r.l+=8;break;case 1:e[1]=parse_Xnum(r,8);break;case 2:e[1]=parse_XLUnicodeString(r);break}return e}function parse_PtgExtraMem(r,e){var a=r.read_shift(2);var t=[];for(var s=0;s!=a;++s)t.push(parse_Ref8U(r,8));return t}function parse_PtgExtraArray(r){var e=1+r.read_shift(1);var a=1+r.read_shift(2);for(var t=0,s=[];t!=a&&(s[t]=[]);++t)for(var p=0;p!=e;++p)s[t][p]=parse_SerAr(r);return s}function parse_PtgName(r,e){var a=r.read_shift(1)>>>5&3;var t=r.read_shift(4);return[a,0,t]}function parse_PtgNameX(r,e){var a=r.read_shift(1)>>>5&3;var t=r.read_shift(2);var s=r.read_shift(4);return[a,t,s]}function parse_PtgMemArea(r,e){var a=r.read_shift(1)>>>5&3;r.l+=4;var t=r.read_shift(2);return[a,t]}function parse_PtgMemFunc(r,e){var a=r.read_shift(1)>>>5&3;var t=r.read_shift(2);return[a,t]}function parse_PtgRefErr(r,e){var a=r.read_shift(1)>>>5&3;r.l+=4;return[a]}var parse_PtgAdd=parseread1;var parse_PtgDiv=parseread1;var parse_PtgEq=parseread1;var parse_PtgGe=parseread1;var parse_PtgGt=parseread1;var parse_PtgIsect=parseread1;var parse_PtgLe=parseread1;var parse_PtgLt=parseread1;var parse_PtgMissArg=parseread1;var parse_PtgMul=parseread1;var parse_PtgNe=parseread1;var parse_PtgParen=parseread1;var parse_PtgPercent=parseread1;var parse_PtgPower=parseread1;var parse_PtgRange=parseread1;var parse_PtgSub=parseread1;var parse_PtgUminus=parseread1;var parse_PtgUnion=parseread1;var parse_PtgUplus=parseread1;var parse_PtgMemErr=parsenoop;var parse_PtgMemNoMem=parsenoop;var parse_PtgRefErr3d=parsenoop;var parse_PtgTbl=parsenoop;var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parse_PtgAdd},4:{n:"PtgSub",f:parse_PtgSub},5:{n:"PtgMul",f:parse_PtgMul},6:{n:"PtgDiv",f:parse_PtgDiv},7:{n:"PtgPower",f:parse_PtgPower},8:{n:"PtgConcat",f:parse_PtgConcat},9:{n:"PtgLt",f:parse_PtgLt},10:{n:"PtgLe",f:parse_PtgLe},11:{n:"PtgEq",f:parse_PtgEq},12:{n:"PtgGe",f:parse_PtgGe},13:{n:"PtgGt",f:parse_PtgGt},14:{n:"PtgNe",f:parse_PtgNe},15:{n:"PtgIsect",f:parse_PtgIsect},16:{n:"PtgUnion",f:parse_PtgUnion},17:{n:"PtgRange",f:parse_PtgRange},18:{n:"PtgUplus",f:parse_PtgUplus},19:{n:"PtgUminus",f:parse_PtgUminus},20:{n:"PtgPercent",f:parse_PtgPercent},21:{n:"PtgParen",f:parse_PtgParen},22:{n:"PtgMissArg",f:parse_PtgMissArg},23:{n:"PtgStr",f:parse_PtgStr},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}};var PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};(function(){for(var r in PtgDupes)PtgTypes[r]=PtgTypes[PtgDupes[r]]})();var Ptg18={};var Ptg19={1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},255:{}};function parse_Formula(r,e,a){var t=parse_XLSCell(r,6);var s=parse_FormulaValue(r,8);var p=r.read_shift(1);r.read_shift(1);var n=r.read_shift(4);var g="";if(a.biff===5)r.l+=e-20;else g=parse_XLSCellParsedFormula(r,e-20,a);return{cell:t,val:s[0],formula:g,shared:p>>3&1,tt:s[1]}}function parse_FormulaValue(r){var e;if(__readUInt16LE(r,r.l+6)!==65535)return[parse_Xnum(r),"n"];switch(r[r.l]){case 0:r.l+=8;return["String","s"];case 1:e=r[r.l+2]===1;r.l+=8;return[e,"b"];case 2:e=r[r.l+2];r.l+=8;return[e,"e"];case 3:r.l+=8;return["","s"]}}function parse_RgbExtra(r,e,a,t){if(t.biff<8)return parsenoop(r,e);var s=r.l+e;var p=[];for(var n=0;n!==a.length;++n){switch(a[n][0]){case"PtgArray":a[n][1]=parse_PtgExtraArray(r);p.push(a[n][1]);break;case"PtgMemArea":a[n][2]=parse_PtgExtraMem(r,a[n][1]);p.push(a[n][2]);break;default:break}}e=s-r.l;if(e!==0)p.push(parsenoop(r,e));return p}function parse_NameParsedFormula(r,e,a,t){var s=r.l+e;var p=parse_Rgce(r,t);var n;if(s!==r.l)n=parse_RgbExtra(r,s-r.l,p,a);return[p,n]}function parse_XLSCellParsedFormula(r,e,a){var t=r.l+e;var s,p=r.read_shift(2);if(p==65535)return[[],parsenoop(r,e-2)];var n=parse_Rgce(r,p);if(e!==p+2)s=parse_RgbExtra(r,e-p-2,n,a);return[n,s]}function parse_SharedParsedFormula(r,e,a){var t=r.l+e;var s,p=r.read_shift(2);var n=parse_Rgce(r,p);if(p==65535)return[[],parsenoop(r,e-2)];if(e!==p+2)s=parse_RgbExtra(r,t-p-2,n,a);return[n,s]}function parse_ArrayParsedFormula(r,e,a,t){var s=r.l+e;var p,n=r.read_shift(2);if(n==65535)return[[],parsenoop(r,e-2)];var g=parse_Rgce(r,n);if(e!==n+2)p=parse_RgbExtra(r,s-n-2,g,a);return[g,p]}function parse_Rgce(r,e){var a=r.l+e;var t,s,p=[];while(a!=r.l){e=a-r.l;s=r[r.l];t=PtgTypes[s];if(s===24||s===25){s=r[r.l+1];t=(s===24?Ptg18:Ptg19)[s]}if(!t||!t.f){p.push(parsenoop(r,e))}else{p.push([t.n,t.f(r,e)])}}return p}function mapper(r){return r.map(function r(e){return e[1]}).join(",")}function stringify_formula(r,e,a,t,s){if(s!==undefined&&s.biff===5)return"BIFF5??";var p=e!==undefined?e:{s:{c:0,r:0}};var n=[],g,P,f,u,c,_,o;if(!r[0]||!r[0][0])return"";for(var i=0,l=r[0].length;i<l;++i){var v=r[0][i];switch(v[0]){case"PtgUminus":n.push("-"+n.pop());break;case"PtgUplus":n.push("+"+n.pop());break;case"PtgPercent":n.push(n.pop()+"%");break;case"PtgAdd":g=n.pop();P=n.pop();n.push(P+"+"+g);break;case"PtgSub":g=n.pop();P=n.pop();n.push(P+"-"+g);break;case"PtgMul":g=n.pop();P=n.pop();n.push(P+"*"+g);break;case"PtgDiv":g=n.pop();P=n.pop();n.push(P+"/"+g);break;case"PtgPower":g=n.pop();P=n.pop();n.push(P+"^"+g);break;case"PtgConcat":g=n.pop();P=n.pop();n.push(P+"&"+g);break;case"PtgLt":g=n.pop();P=n.pop();n.push(P+"<"+g);break;case"PtgLe":g=n.pop();P=n.pop();n.push(P+"<="+g);break;case"PtgEq":g=n.pop();P=n.pop();n.push(P+"="+g);break;case"PtgGe":g=n.pop();P=n.pop();n.push(P+">="+g);break;case"PtgGt":g=n.pop();P=n.pop();n.push(P+">"+g);break;case"PtgNe":g=n.pop();P=n.pop();n.push(P+"<>"+g);break;case"PtgIsect":g=n.pop();P=n.pop();n.push(P+" "+g);break;case"PtgUnion":g=n.pop();P=n.pop();n.push(P+","+g);break;case"PtgRange":break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgRef":f=v[1][0];u=shift_cell_xls(decode_cell(encode_cell(v[1][1])),p);n.push(encode_cell(u));break;case"PtgRefN":f=v[1][0];u=shift_cell_xls(decode_cell(encode_cell(v[1][1])),a);n.push(encode_cell(u));break;case"PtgRef3d":f=v[1][0];c=v[1][1];u=shift_cell_xls(v[1][2],p);n.push(t[1][c+1]+"!"+encode_cell(u));break;case"PtgFunc":case"PtgFuncVar":var d=v[1][0],h=v[1][1];if(!d)d=0;var A=n.slice(-d);n.length-=d;if(h==="User")h=A.shift();n.push(h+"("+A.join(",")+")");break;case"PtgBool":n.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":n.push(v[1]);break;case"PtgNum":n.push(String(v[1]));break;case"PtgStr":n.push('"'+v[1]+'"');break;case"PtgErr":n.push(v[1]);break;case"PtgArea":f=v[1][0];o=shift_range_xls(v[1][1],p);n.push(encode_range(o));break;case"PtgArea3d":f=v[1][0];c=v[1][1];o=v[1][2];n.push(t[1][c+1]+"!"+encode_range(o));break;case"PtgAttrSum":n.push("SUM("+n.pop()+")");break;case"PtgAttrSemi":break;case"PtgName":_=v[1][2];var b=t[0][_];var m=b.Name;if(m in XLSXFutureFunctions)m=XLSXFutureFunctions[m];n.push(m);break;case"PtgNameX":var R=v[1][1];_=v[1][2];var k;if(t[R+1])k=t[R+1][_];else if(t[R-1])k=t[R-1][_];if(!k)k={body:"??NAMEX??"};n.push(k.body);break;case"PtgParen":n.push("("+n.pop()+")");break;case"PtgRefErr":n.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var E={c:a.c,r:a.r};if(t.sharedf[encode_cell(u)]){var S=t.sharedf[encode_cell(u)];n.push(stringify_formula(S,p,E,t,s))}else{var F=false;for(g=0;g!=t.arrayf.length;++g){P=t.arrayf[g];if(u.c<P[0].s.c||u.c>P[0].e.c)continue;if(u.r<P[0].s.r||u.r>P[0].e.r)continue;n.push(stringify_formula(P[1],p,E,t,s))}if(!F)n.push(v[1])}break;case"PtgArray":n.push("{"+v[1].map(mapper).join(";")+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":n.push("");break;case"PtgAreaErr":break;case"PtgAreaN":n.push("");break;case"PtgRefErr3d":break;case"PtgMemFunc":break;default:throw"Unrecognized Formula Token: "+v}}return n[0]}