function hex2RGB(r){var a=r.substr(r[0]==="#"?1:0,6);return[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]}function rgb2Hex(r){for(var a=0,e=1;a!=3;++a)e=e*256+(r[a]>255?255:r[a]<0?0:r[a]);return e.toString(16).toUpperCase().substr(1)}function rgb2HSL(r){var a=r[0]/255,e=r[1]/255,t=r[2]/255;var i=Math.max(a,e,t),n=Math.min(a,e,t),s=i-n;if(s===0)return[0,0,a];var D=0,c=0,M=i+n;c=s/(M>1?2-M:M);switch(i){case a:D=((e-t)/s+6)%6;break;case e:D=(t-a)/s+2;break;case t:D=(a-e)/s+4;break}return[D/6,c,M/2]}function hsl2RGB(r){var a=r[0],e=r[1],t=r[2];var i=e*2*(t<.5?t:1-t),n=t-i/2;var s=[n,n,n],D=6*a;var c;if(e!==0)switch(D|0){case 0:case 6:c=i*D;s[0]+=i;s[1]+=c;break;case 1:c=i*(2-D);s[0]+=c;s[1]+=i;break;case 2:c=i*(D-2);s[1]+=i;s[2]+=c;break;case 3:c=i*(4-D);s[1]+=c;s[2]+=i;break;case 4:c=i*(D-4);s[2]+=i;s[0]+=c;break;case 5:c=i*(6-D);s[2]+=c;s[0]+=i;break}for(var M=0;M!=3;++M)s[M]=Math.round(s[M]*255);return s}function rgb_tint(r,a){if(a==0)return r;var e=rgb2HSL(hex2RGB(r));if(a<0)e[2]=e[2]*(1+a);else e[2]=1-(1-e[2])*(1-a);var t=rgb2Hex(hsl2RGB(e));return t}var DEF_MDW=7,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(r){return(r+(128/MDW|0)/256)*MDW|0}function px2char(r){return((r-5)/MDW*100+.5|0)/100}function char2width(r){return((r*MDW+5)/MDW*256|0)/256}function cycle_width(r){return char2width(px2char(width2px(r)))}function find_mdw(r,a){if(cycle_width(r)!=r){for(MDW=DEF_MDW;MDW>MIN_MDW;--MDW)if(cycle_width(r)===r)break;if(MDW===MIN_MDW)for(MDW=DEF_MDW+1;MDW<MAX_MDW;++MDW)if(cycle_width(r)===r)break;if(MDW===MAX_MDW)MDW=DEF_MDW}}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};