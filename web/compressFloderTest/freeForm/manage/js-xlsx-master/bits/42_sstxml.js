var CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969};var parse_rs=function e(){var r=matchtag("t"),a=matchtag("rPr"),s=/<r>/g,t=/<\/r>/,i=/\r\n/g;var n=function e(r,a,s){var t={},i=65001;var n=r.match(tagregex),c=0;if(n)for(;c!=n.length;++c){var l=parsexmltag(n[c]);switch(l[0]){case"<condense":break;case"<extend":break;case"<shadow":case"<shadow/>":break;case"<charset":if(l.val=="1")break;i=CS2CP[parseInt(l.val,10)];break;case"<outline":case"<outline/>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(!l.val)break;case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(!l.val)break;case"<i/>":t.i=1;break;case"</i>":break;case"<color":if(l.rgb)t.color=l.rgb.substr(2,6);break;case"<family":t.family=l.val;break;case"<vertAlign":break;case"<scheme":break;default:if(l[0].charCodeAt(1)!==47)throw"Unrecognized rich format "+l[0]}}var u=[];if(t.b)u.push("font-weight: bold;");if(t.i)u.push("font-style: italic;");a.push('<span style="'+u.join("")+'">');s.push("</span>");return i};function c(e){var s=[[],"",[]];var t=e.match(r),c=65001;if(!isval(t))return"";s[1]=t[1];var l=e.match(a);if(isval(l))c=n(l[1],s[0],s[2]);return s[0].join("")+s[1].replace(i,"<br/>")+s[2].join("")}return function e(r){return r.replace(s,"").split(t).map(c).join("")}}();var sitregex=/<t[^>]*>([^<]*)<\/t>/g,sirregex=/<r>/;function parse_si(e,r){var a=r?r.cellHTML:true;var s={};if(!e)return null;var t;if(e.charCodeAt(1)===116){s.t=utf8read(unescapexml(e.substr(e.indexOf(">")+1).split(/<\/t>/)[0]));s.r=e;if(a)s.h=s.t}else if(t=e.match(sirregex)){s.r=e;s.t=utf8read(unescapexml(e.match(sitregex).join("").replace(tagregex,"")));if(a)s.h=parse_rs(e)}return s}var sstr0=/<sst([^>]*)>([\s\S]*)<\/sst>/;var sstr1=/<(?:si|sstItem)>/g;var sstr2=/<\/(?:si|sstItem)>/;function parse_sst_xml(e,r){var a=[],s;var t=e.match(sstr0);if(isval(t)){s=t[2].replace(sstr1,"").split(sstr2);for(var i=0;i!=s.length;++i){var n=parse_si(s[i],r);if(n!=null)a[a.length]=n}t=parsexmltag(t[1]);a.Count=t.count;a.Unique=t.uniqueCount}return a}RELS.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,r){if(!r.bookSST)return"";var a=[XML_HEADER];a[a.length]=writextag("sst",null,{xmlns:XMLNS.main[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s){if(e[s]==null)continue;var t=e[s];var i="<si>";if(t.r)i+=t.r;else{i+="<t";if(t.t.match(straywsregex))i+=' xml:space="preserve"';i+=">"+escapexml(t.t)+"</t>"}i+="</si>";a[a.length]=i}if(a.length>2){a[a.length]="</sst>";a[1]=a[1].replace("/>",">")}return a.join("")}