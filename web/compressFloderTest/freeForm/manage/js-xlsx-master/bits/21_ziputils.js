function getdata(e){if(!e)return null;if(e.name.substr(-4)===".bin"){if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent)return Array.prototype.slice.call(e._data.getContent())}else{if(e.data)return e.name.substr(-4)!==".bin"?debom_xml(e.data):char_codes(e.data);if(e.asNodeBuffer&&has_buf)return debom_xml(e.asNodeBuffer().toString("binary"));if(e.asBinary)return debom_xml(e.asBinary());if(e._data&&e._data.getContent)return debom_xml(cc2str(Array.prototype.slice.call(e._data.getContent(),0)))}return null}function safegetzipfile(e,t){var r=t;if(e.files[r])return e.files[r];var i={};for(var n in e.files){i[n.toLowerCase()]=e.files[n]}r=t.toLowerCase();if(i[r])return i[r];r=r.replace(/\//g,"\\");if(i[r])return i[r];return null}function getzipfile(e,t){var r=safegetzipfile(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function getzipdata(e,t,r){if(!r)return getdata(getzipfile(e,t));if(!t)return null;try{return getzipdata(e,t)}catch(e){return null}}var _fs,jszip;if(typeof JSZip!=="undefined")jszip=JSZip;if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){if(has_buf&&typeof jszip==="undefined")jszip=require("js"+"zip");if(typeof jszip==="undefined")jszip=require("./js"+"zip").JSZip;_fs=require("f"+"s")}}