var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument"};function parse_rels(e,t){if(!e)return e;if(t.charAt(0)!=="/"){t="/"+t}var r={};var a={};var i=function(e){var r=t.split("/");r.pop();var a=e.split("/");var i=[];while(a.length!==0){var n=a.shift();if(n===".."){r.pop()}else if(n!=="."){r.push(n)}}return r.join("/")};e.match(tagregex).forEach(function(e){var t=parsexmltag(e);if(t[0]==="<Relationship"){var n={};n.Type=t.Type;n.Target=t.Target;n.Id=t.Id;n.TargetMode=t.TargetMode;var o=t.TargetMode==="External"?t.Target:i(t.Target);r[o]=n;a[t.Id]=n}});r["!id"]=a;return r}XMLNS.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var RELS_ROOT=writextag("Relationships",null,{xmlns:XMLNS.RELS});function write_rels(e){var t=[];t[t.length]=XML_HEADER;t[t.length]=RELS_ROOT;keys(e["!id"]).forEach(function(r){var a=e["!id"][r];t[t.length]=writextag("Relationship",null,a)});if(t.length>2){t[t.length]="</Relationships>";t[1]=t[1].replace("/>",">")}return t.join("")}