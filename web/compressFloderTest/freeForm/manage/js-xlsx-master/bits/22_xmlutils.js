var attregexg=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g;var tagregex=/<[^>]*>/g;var nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,r){var t=[];var n=0,a=0;for(;n!==e.length;++n)if((a=e.charCodeAt(n))===32||a===10||a===13)break;if(!r)t[0]=e.substr(0,n);if(n===e.length)return t;var o=e.match(attregexg),c=0,i="",s="",u=0,f="",g="";if(o)for(u=0;u!=o.length;++u){g=o[u];for(a=0;a!=g.length;++a)if(g.charCodeAt(a)===61)break;f=g.substr(0,a);s=g.substring(a+2,g.length-1);for(c=0;c!=f.length;++c)if(f.charCodeAt(c)===58)break;if(c===f.length)t[f]=s;else t[(c===5&&f.substr(0,5)==="xmlns"?"xmlns":"")+f.substr(c+1)]=s}return t}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"};var rencoding=evert(encodings);var rencstr="&<>'\"".split("");var unescapexml=function(){var e=/&[a-z]*;/g,r=/_x([\da-fA-F]+)_/g;return function t(n){var a=n+"";return a.replace(e,function(e){return encodings[e]}).replace(r,function(e,r){return String.fromCharCode(parseInt(r,16))})}}();var decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var r=e+"";return r.replace(decregex,function(e){return rencoding[e]}).replace(charegex,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).substr(-4)+"_"})}var xlml_fixstr=function(){var e=/&#(\d+);/g;function r(e,r){return String.fromCharCode(parseInt(r,10))}return function t(n){return n.replace(e,r)}}();function parsexmlbool(e,r){switch(e){case"1":case"true":case"TRUE":return true;default:return false}}var utf8read=function e(r){var t="",n=0,a=0,o=0,c=0,i=0,s=0;while(n<r.length){a=r.charCodeAt(n++);if(a<128){t+=String.fromCharCode(a);continue}o=r.charCodeAt(n++);if(a>191&&a<224){t+=String.fromCharCode((a&31)<<6|o&63);continue}c=r.charCodeAt(n++);if(a<240){t+=String.fromCharCode((a&15)<<12|(o&63)<<6|c&63);continue}i=r.charCodeAt(n++);s=((a&7)<<18|(o&63)<<12|(c&63)<<6|i&63)-65536;t+=String.fromCharCode(55296+(s>>>10&1023));t+=String.fromCharCode(56320+(s&1023))}return t};if(has_buf){var utf8readb=function e(r){var t=new Buffer(2*r.length),n,a,o=1,c=0,i=0,s;for(a=0;a<r.length;a+=o){o=1;if((s=r.charCodeAt(a))<128)n=s;else if(s<224){n=(s&31)*64+(r.charCodeAt(a+1)&63);o=2}else if(s<240){n=(s&15)*4096+(r.charCodeAt(a+1)&63)*64+(r.charCodeAt(a+2)&63);o=3}else{o=4;n=(s&7)*262144+(r.charCodeAt(a+1)&63)*4096+(r.charCodeAt(a+2)&63)*64+(r.charCodeAt(a+3)&63);n-=65536;i=55296+(n>>>10&1023);n=56320+(n&1023)}if(i!==0){t[c++]=i&255;t[c++]=i>>>8;i=0}t[c++]=n%256;t[c++]=n>>>8}t.length=c;return t.toString("ucs2")};var corpus="foo bar bazâð£";if(utf8read(corpus)==utf8readb(corpus))utf8read=utf8readb;var utf8readc=function e(r){return Buffer(r,"binary").toString("utf8")};if(utf8read(corpus)==utf8readc(corpus))utf8read=utf8readc}var matchtag=function(){var e={};return function r(t,n){var a=t+"|"+n;if(e[a]!==undefined)return e[a];return e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([^☃]*)</(?:\\w+:)?'+t+">",n||"")}}();var vtregex=function(){var e={};return function r(t){if(e[t]!==undefined)return e[t];return e[t]=new RegExp("<vt:"+t+">(.*?)</vt:"+t+">","g")}}();var vtvregex=/<\/?vt:variant>/g,vtmregex=/<vt:([^>]*)>(.*)</;function parseVector(e){var r=parsexmltag(e);var t=e.match(vtregex(r.baseType))||[];if(t.length!=r.size)throw"unexpected vector length "+t.length+" != "+r.size;var n=[];t.forEach(function(e){var r=e.replace(vtvregex,"").match(vtmregex);n.push({v:r[2],t:r[1]})});return n}var wtregex=/(^\s|\s$|\n)/;function writetag(e,r){return"<"+e+(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function writextag(e,r,t){return"<"+e+(isval(t)?wxt_helper(t):"")+(isval(r)?(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function write_w3cdtf(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}}function write_vt(e){switch(typeof e){case"string":return writextag("vt:lpwstr",e);case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",String(e));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}var XML_HEADER='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var XMLNS={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"};XMLNS.main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];