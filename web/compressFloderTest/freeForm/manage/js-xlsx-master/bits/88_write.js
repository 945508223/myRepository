function write_zip_type(e,r){var t=r||{};style_builder=new StyleBuilder(r);var s=write_zip(e,t);switch(t.type){case"base64":return s.generate({type:"base64"});case"binary":return s.generate({type:"string"});case"buffer":return s.generate({type:"nodebuffer"});case"file":return _fs.writeFileSync(t.file,s.generate({type:"nodebuffer"}));default:throw new Error("Unrecognized type "+t.type)}}function writeSync(e,r){var t=r||{};switch(t.bookType){case"xml":return write_xlml(e,t);default:return write_zip_type(e,t)}}function writeFileSync(e,r,t){var s=t||{};s.type="file";s.file=r;switch(s.file.substr(-5).toLowerCase()){case".xlsx":s.bookType="xlsx";break;case".xlsm":s.bookType="xlsm";break;case".xlsb":s.bookType="xlsb";break;default:switch(s.file.substr(-4).toLowerCase()){case".xls":s.bookType="xls";break;case".xml":s.bookType="xml";break}}return writeSync(e,s)}