var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];XMLNS.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";RELS.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";function parse_ext_props(e,t){var r={};if(!t)t={};EXT_PROPS.forEach(function(a){switch(a[2]){case"string":t[a[1]]=(e.match(matchtag(a[0]))||[])[1];break;case"bool":t[a[1]]=(e.match(matchtag(a[0]))||[])[1]==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>(.*)</"+a[0]+">"));if(s&&s.length>0)r[a[1]]=s[1];break}});if(r.HeadingPairs&&r.TitlesOfParts){var a=parseVector(r.HeadingPairs);var s=0,i=0;for(var n=0;n!==a.length;++n){switch(a[n].v){case"Worksheets":i=s;t.Worksheets=+a[++n].v;break;case"Named Ranges":++n;break}}var o=parseVector(r.TitlesOfParts).map(function(e){return utf8read(e.v)});t.SheetNames=o.slice(i,i+t.Worksheets)}return t}var EXT_PROPS_XML_ROOT=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt});function write_ext_props(e,t){var r=[],a={},s=writextag;if(!e)e={};e.Application="SheetJS";r[r.length]=XML_HEADER;r[r.length]=EXT_PROPS_XML_ROOT;EXT_PROPS.forEach(function(t){if(e[t[1]]===undefined)return;var a;switch(t[2]){case"string":a=e[t[1]];break;case"bool":a=e[t[1]]?"true":"false";break}if(a!==undefined)r[r.length]=s(t[0],a)});r[r.length]=s("HeadingPairs",s("vt:vector",s("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+s("vt:variant",s("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"}));r[r.length]=s("TitlesOfParts",s("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+e+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"}));if(r.length>2){r[r.length]="</Properties>";r[1]=r[1].replace("/>",">")}return r.join("")}