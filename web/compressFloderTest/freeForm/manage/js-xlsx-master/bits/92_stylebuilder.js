var StyleBuilder=function(t){var e=164;var r={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'};var l={};for(var n in r){l[r[n]]=n}_hashIndex={};_listIndex=[];return{initialize:function(t){this.$fonts=XmlNode("fonts").attr("count",0).attr("x14ac:knownFonts","1");this.$fills=XmlNode("fills").attr("count",0);this.$borders=XmlNode("borders").attr("count",0);this.$numFmts=XmlNode("numFmts").attr("count",0);this.$cellStyleXfs=XmlNode("cellStyleXfs");this.$xf=XmlNode("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0);this.$cellXfs=XmlNode("cellXfs").attr("count",0);this.$cellStyles=XmlNode("cellStyles").append(XmlNode("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0));this.$dxfs=XmlNode("dxfs").attr("count","0");this.$tableStyles=XmlNode("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4");this.$styles=XmlNode("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var e=t.defaultCellStyle||{};if(!e.font)e.font={name:"Calibri",sz:"12"};if(!e.font.name)e.font.name="Calibri";if(!e.font.sz)e.font.sz=11;if(!e.fill)e.fill={patternType:"none",fgColor:{}};if(!e.border)e.border={};if(!e.numFmt)e.numFmt=0;this.defaultStyle=e;var r=JSON.parse(JSON.stringify(e));r.fill={patternType:"gray125",fgColor:{}};this.addStyles([e,r]);return this},addStyle:function(t){var e=JSON.stringify(t);var r=_hashIndex[e];if(r==undefined){r=this._addXf(t);_hashIndex[e]=r}else{r=_hashIndex[e]}return r},addStyles:function(t){var e=this;return t.map(function(t){return e.addStyle(t)})},_duckTypeStyle:function(t){if(typeof t=="object"&&(t.patternFill||t.fgColor)){return{fill:t}}else if(t.font||t.numFmt||t.border||t.fill){return t}else{return this._getStyleCSS(t)}},_getStyleCSS:function(t){return t},_addXf:function(t){var e=this._addFont(t.font);var r=this._addFill(t.fill);var l=this._addBorder(t.border);var n=this._addNumFmt(t.numFmt);var a=XmlNode("xf").attr("numFmtId",n).attr("fontId",e).attr("fillId",r).attr("borderId",l).attr("xfId","0");if(e>0){a.attr("applyFont","1")}if(r>0){a.attr("applyFill","1")}if(l>0){a.attr("applyBorder","1")}if(n>0){a.attr("applyNumberFormat","1")}if(t.alignment){var o=XmlNode("alignment");if(t.alignment.horizontal){o.attr("horizontal",t.alignment.horizontal)}if(t.alignment.vertical){o.attr("vertical",t.alignment.vertical)}if(t.alignment.indent){o.attr("indent",t.alignment.indent)}if(t.alignment.readingOrder){o.attr("readingOrder",t.alignment.readingOrder)}if(t.alignment.wrapText){o.attr("wrapText",t.alignment.wrapText)}if(t.alignment.textRotation!=undefined){o.attr("textRotation",t.alignment.textRotation)}a.append(o).attr("applyAlignment",1)}this.$cellXfs.append(a);var i=+this.$cellXfs.children().length;this.$cellXfs.attr("count",i);return i-1},_addFont:function(t){if(!t){return 0}var e=XmlNode("font").append(XmlNode("sz").attr("val",t.sz||this.defaultStyle.font.sz)).append(XmlNode("name").attr("val",t.name||this.defaultStyle.font.name));if(t.bold)e.append(XmlNode("b"));if(t.underline)e.append(XmlNode("u"));if(t.italic)e.append(XmlNode("i"));if(t.strike)e.append(XmlNode("strike"));if(t.outline)e.append(XmlNode("outline"));if(t.shadow)e.append(XmlNode("shadow"));if(t.vertAlign){e.append(XmlNode("vertAlign").attr("val",t.vertAlign))}if(t.color){if(t.color.theme){e.append(XmlNode("color").attr("theme",t.color.theme));if(t.color.tint){e.append(XmlNode("tint").attr("theme",t.color.tint))}}else if(t.color.rgb){e.append(XmlNode("color").attr("rgb",t.color.rgb))}}this.$fonts.append(e);var r=this.$fonts.children().length;this.$fonts.attr("count",r);return r-1},_addNumFmt:function(t){if(!t){return 0}if(typeof t=="string"){var r=l[t];if(r>=0){return r}}if(/^[0-9]+$/.exec(t)){return t}t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");var n=XmlNode("numFmt").attr("numFmtId",++e).attr("formatCode",t);this.$numFmts.append(n);var a=this.$numFmts.children().length;this.$numFmts.attr("count",a);return e},_addFill:function(t){if(!t){return 0}var e=XmlNode("patternFill").attr("patternType",t.patternType||"solid");if(t.fgColor){var r=XmlNode("fgColor");if(t.fgColor.rgb){if(t.fgColor.rgb.length==6){t.fgColor.rgb="FF"+t.fgColor.rgb}r.attr("rgb",t.fgColor.rgb);e.append(r)}else if(t.fgColor.theme){r.attr("theme",t.fgColor.theme);if(t.fgColor.tint){r.attr("tint",t.fgColor.tint)}e.append(r)}if(!t.bgColor){t.bgColor={indexed:"64"}}}if(t.bgColor){var l=XmlNode("bgColor").attr(t.bgColor);e.append(l)}var n=XmlNode("fill").append(e);this.$fills.append(n);var a=this.$fills.children().length;this.$fills.attr("count",a);return a-1},_getSubBorder:function(t,e){var r=XmlNode(t);if(e){if(e.style)r.attr("style",e.style);if(e.color){var l=XmlNode("color");if(e.color.auto){l.attr("auto",e.color.auto)}else if(e.color.rgb){l.attr("rgb",e.color.rgb)}else if(e.color.theme||e.color.tint){l.attr("theme",e.color.theme||"1");l.attr("tint",e.color.tint||"0")}r.append(l)}}return r},_addBorder:function(t){if(!t){return 0}var e=this;var r=XmlNode("border").attr("diagonalUp",t.diagonalUp).attr("diagonalDown",t.diagonalDown);var l=["left","right","top","bottom","diagonal"];l.forEach(function(l){r.append(e._getSubBorder(l,t[l]))});this.$borders.append(r);var n=this.$borders.children().length;this.$borders.attr("count",n);return n-1},toXml:function(){return this.$styles.toXml()}}.initialize(t||{})};