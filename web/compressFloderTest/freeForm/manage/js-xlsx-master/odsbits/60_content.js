var parse_content_xml=function(){var e={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"]};return function a(s,r){var t=xlml_normalize(s);var c=[],l;var n;var b,i,o;var p;var k={},m=[],d={};var u,f;var h;var g,y,v;var x,w,_={s:{r:1e6,c:1e7},e:{r:0,c:0}};var A={};var F=[],B={},I=0,z=0;while(u=xlmlregex.exec(t))switch(u[3]){case"table":if(u[1]==="/"){if(_.e.c>=_.s.c&&_.e.r>=_.s.r)d["!ref"]=get_utils().encode_range(_);if(F.length)d["!merges"]=F;m.push(p.name);k[p.name]=d}else if(u[0].charAt(u[0].length-2)!=="/"){p=parsexmltag(u[0]);x=w=-1;_.s.r=_.s.c=1e7;_.e.r=_.e.c=0;d={};F=[]}break;case"table-row":if(u[1]==="/")break;++x;w=-1;break;case"covered-table-cell":++w;break;case"table-cell":if(u[0].charAt(u[0].length-2)==="/"){h=parsexmltag(u[0]);if(h["number-columns-repeated"])w+=parseInt(h["number-columns-repeated"],10);else++w}else if(u[1]!=="/"){++w;if(w>_.e.c)_.e.c=w;if(x>_.e.r)_.e.r=x;if(w<_.s.c)_.s.c=w;if(x<_.s.r)_.s.r=x;h=parsexmltag(u[0]);f={t:h["value-type"],v:null};if(h["number-columns-spanned"]||h["number-rows-spanned"]){I=parseInt(h["number-rows-spanned"],10)||0;z=parseInt(h["number-columns-spanned"],10)||0;B={s:{r:x,c:w},e:{r:x+I-1,c:w+z-1}};F.push(B)}switch(f.t){case"boolean":f.t="b";f.v=parsexmlbool(h["boolean-value"]);break;case"float":f.t="n";f.v=parseFloat(h.value);break;case"percentage":f.t="n";f.v=parseFloat(h.value);break;case"currency":f.t="n";f.v=parseFloat(h.value);break;case"date":f.t="n";f.v=datenum(h["date-value"]);f.z="m/d/yy";break;case"time":f.t="n";f.v=parse_isodur(h["time-value"])/86400;break;case"string":f.t="s";break;default:throw new Error("Unsupported value type "+f.t)}}else{if(f.t==="s")f.v=g;if(g)f.w=g;if(!(r.sheetRows&&r.sheetRows<x))d[get_utils().encode_cell({r:x,c:w})]=f;f=null}break;case"document-content":case"spreadsheet":case"scripts":case"font-face-decls":if(u[1]==="/"){if((l=c.pop())[0]!==u[3])throw"Bad state: "+l}else if(u[0].charAt(u[0].length-2)!=="/")c.push([u[3],true]);break;case"shapes":case"frame":if(u[1]==="/"){if((l=c.pop())[0]!==u[3])throw"Bad state: "+l}else if(u[0].charAt(u[0].length-2)!=="/")c.push([u[3],false]);break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(u[1]==="/"){A[b.name]=i;if((l=c.pop())[0]!==u[3])throw"Bad state: "+l}else if(u[0].charAt(u[0].length-2)!=="/"){i="";b=parsexmltag(u[0]);c.push([u[3],true])}break;case"script":break;case"automatic-styles":break;case"style":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(c[c.length-1][0]){case"time-style":case"date-style":n=parsexmltag(u[0]);i+=e[u[3]][n.style==="long"?1:0];break}break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(c[c.length-1][0]){case"time-style":case"date-style":n=parsexmltag(u[0]);i+=e[u[3]][n.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(u[0].substr(-2)==="/>")break;else if(u[1]==="/")switch(c[c.length-1][0]){case"number-style":case"date-style":case"time-style":i+=t.slice(o,u.index);break}else o=u.index+u[0].length;break;case"text-content":break;case"text-properties":break;case"body":break;case"forms":break;case"table-column":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"named-range":break;case"span":break;case"p":if(u[1]==="/")g=parse_text_p(t.slice(y,u.index),v);else{v=parsexmltag(u[0]);y=u.index+u[0].length}break;case"s":break;case"date":break;case"annotation":break;case"object":break;case"title":break;case"desc":break;case"database-ranges":break;case"database-range":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;default:if(r.WTF)throw u}var M={Sheets:k,SheetNames:m};return M}}();