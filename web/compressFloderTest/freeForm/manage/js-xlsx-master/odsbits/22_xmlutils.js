var attregexg=/\b[\w:-]+=["'][^"]*['"]/g;var tagregex=/<[^>]*>/g;var nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,r){var t=[];var n=0,a=0;for(;n!==e.length;++n)if((a=e.charCodeAt(n))===32||a===10||a===13)break;if(!r)t[0]=e.substr(0,n);if(n===e.length)return t;var s=e.match(attregexg),u=0,o="",c="",g=0,i="",f="";if(s)for(g=0;g!=s.length;++g){f=s[g];for(a=0;a!=f.length;++a)if(f.charCodeAt(a)===61)break;i=f.substr(0,a);c=f.substring(a+2,f.length-1);for(u=0;u!=i.length;++u)if(i.charCodeAt(u)===58)break;if(u===i.length)t[i]=c;else t[(u===5&&i.substr(0,5)==="xmlns"?"xmlns":"")+i.substr(u+1)]=c}return t}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"};var rencoding={'"':"&quot;","'":"&apos;",">":"&gt;","<":"&lt;","&":"&amp;"};var rencstr="&<>'\"".split("");var encregex=/&[a-z]*;/g,coderegex=/_x([\da-fA-F]+)_/g;function unescapexml(e){var r=e+"";return r.replace(encregex,function(e){return encodings[e]}).replace(coderegex,function(e,r){return String.fromCharCode(parseInt(r,16))})}var decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var r=e+"";return r.replace(decregex,function(e){return rencoding[e]}).replace(charegex,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).substr(-4)+"_"})}function parsexmlbool(e,r){switch(e){case"1":case"true":case"TRUE":return true;default:return false}}function datenum(e){var r=Date.parse(e);return(r+22091616e5)/(24*60*60*1e3)}function parse_isodur(e){var r=0,t=0,n=false;var a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s){if(!a[s])continue;t=1;if(s>3)n=true;switch(a[s].substr(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].substr(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");else t*=60;case"S":break}r+=t*parseInt(a[s],10)}return r}