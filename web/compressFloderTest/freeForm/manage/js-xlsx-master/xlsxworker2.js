importScripts("jszip.js");importScripts("xlsx.js");importScripts("dist/ods.js");postMessage({t:"ready"});function ab2str(r){var t="",a=0,s=10240;for(;a<r.byteLength/s;++a)t+=String.fromCharCode.apply(null,new Uint16Array(r.slice(a*s,a*s+s)));t+=String.fromCharCode.apply(null,new Uint16Array(r.slice(a*s)));return t}function s2ab(r){var t=new ArrayBuffer(r.length*2),a=new Uint16Array(t);for(var s=0;s!=r.length;++s)a[s]=r.charCodeAt(s);return[a,t]}onmessage=function(r){var t;try{t=XLSX.read(ab2str(r.data),{type:"binary"})}catch(r){postMessage({t:"e",d:r.stack})}var a={t:"xlsx",d:JSON.stringify(t)};var s=s2ab(a.d)[1];postMessage(s,[s])};